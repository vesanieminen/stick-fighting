import{r as U,g as V}from"./phaser-Czz4FBZH.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();var Y=U();const f=V(Y);class X extends f.Scene{constructor(){super("BootScene")}create(){this.registry.set("p1Wins",0),this.registry.set("p2Wins",0),this.registry.set("currentRound",1),this.scene.start("TitleScene")}}const d={GROUND_Y:620,STAGE_LEFT:50,STAGE_RIGHT:1230,MAX_HEALTH:100,PUNCH_DURATION:250,PUNCH_KNOCKBACK:200,KICK_DURATION:400,KICK_KNOCKBACK:350,SPECIAL_DURATION:500,SPECIAL_KNOCKBACK:500,SPECIAL_COOLDOWN:3e3,BLOCK_DAMAGE_REDUCTION:.8,ROUNDS_TO_WIN:2,ROUND_END_DELAY:2e3,HITSTUN_DURATION:300,HEAD_RADIUS:14,LINE_WIDTH:4,BODY_WIDTH:40,BODY_HEIGHT:120};class T{constructor(e){this.graphics=e}draw(e,t,i,s,a=16777215,n=!1){const h=this.graphics,r=s?1:-1;if(h.clear(),n){const y=this.transformPose(e-r*10,t,i,r);this.drawFigure(h,y,a,.12)}const c=this.transformPose(e,t,i,r);this.drawFigure(h,c,a,1)}transformPose(e,t,i,s){const a={};for(const n in i)a[n]={x:e+i[n].x*s,y:t+i[n].y};return a}drawFigure(e,t,i,s){const a=d.LINE_WIDTH,n=d.HEAD_RADIUS;e.fillStyle(i,.25*s),e.fillCircle(t.head.x,t.head.y,n),e.lineStyle(a,i,s),e.strokeCircle(t.head.x,t.head.y,n),e.lineStyle(a+1,i,s),e.lineBetween(t.neck.x,t.neck.y,t.hip.x,t.hip.y),e.lineStyle(a,i,s),e.lineBetween(t.shoulderL.x,t.shoulderL.y,t.shoulderR.x,t.shoulderR.y),this.drawLimb(e,t.shoulderL,t.elbowL,i,a,s),this.drawLimb(e,t.elbowL,t.handL,i,a,s),this.drawLimb(e,t.shoulderR,t.elbowR,i,a,s),this.drawLimb(e,t.elbowR,t.handR,i,a,s),this.drawLimb(e,t.hip,t.kneeL,i,a,s),this.drawLimb(e,t.kneeL,t.footL,i,a,s),this.drawLimb(e,t.hip,t.kneeR,i,a,s),this.drawLimb(e,t.kneeR,t.footR,i,a,s),e.fillStyle(i,.7*s);const h=2.5;e.fillCircle(t.elbowL.x,t.elbowL.y,h),e.fillCircle(t.elbowR.x,t.elbowR.y,h),e.fillCircle(t.kneeL.x,t.kneeL.y,h),e.fillCircle(t.kneeR.x,t.kneeR.y,h);const r=3;e.fillCircle(t.handL.x,t.handL.y,r),e.fillCircle(t.handR.x,t.handR.y,r),e.fillCircle(t.footL.x,t.footL.y,r),e.fillCircle(t.footR.x,t.footR.y,r)}drawLimb(e,t,i,s,a,n){e.lineStyle(a,s,n),e.lineBetween(t.x,t.y,i.x,i.y)}}const w={IDLE:[{head:{x:3,y:-100},neck:{x:2,y:-82},hip:{x:0,y:-2},shoulderL:{x:-15,y:-80},shoulderR:{x:15,y:-80},elbowL:{x:-3,y:-62},elbowR:{x:26,y:-66},handL:{x:12,y:-80},handR:{x:32,y:-84},kneeL:{x:-18,y:24},kneeR:{x:18,y:24},footL:{x:-24,y:60},footR:{x:22,y:60}},{head:{x:3,y:-97},neck:{x:2,y:-79},hip:{x:0,y:2},shoulderL:{x:-15,y:-77},shoulderR:{x:15,y:-77},elbowL:{x:-5,y:-59},elbowR:{x:24,y:-63},handL:{x:10,y:-77},handR:{x:30,y:-81},kneeL:{x:-18,y:27},kneeR:{x:18,y:27},footL:{x:-24,y:60},footR:{x:22,y:60}},{head:{x:3,y:-94},neck:{x:2,y:-76},hip:{x:0,y:6},shoulderL:{x:-15,y:-74},shoulderR:{x:15,y:-74},elbowL:{x:-7,y:-56},elbowR:{x:22,y:-60},handL:{x:8,y:-74},handR:{x:28,y:-78},kneeL:{x:-18,y:30},kneeR:{x:18,y:30},footL:{x:-24,y:60},footR:{x:22,y:60}},{head:{x:3,y:-97},neck:{x:2,y:-79},hip:{x:0,y:2},shoulderL:{x:-15,y:-77},shoulderR:{x:15,y:-77},elbowL:{x:-5,y:-59},elbowR:{x:24,y:-63},handL:{x:10,y:-77},handR:{x:30,y:-81},kneeL:{x:-18,y:27},kneeR:{x:18,y:27},footL:{x:-24,y:60},footR:{x:22,y:60}}],WALK_FORWARD:[{head:{x:8,y:-98},neck:{x:6,y:-80},hip:{x:0,y:0},shoulderL:{x:-12,y:-78},shoulderR:{x:16,y:-78},elbowL:{x:8,y:-64},elbowR:{x:10,y:-58},handL:{x:20,y:-74},handR:{x:6,y:-44},kneeL:{x:-8,y:26},kneeR:{x:26,y:20},footL:{x:-14,y:60},footR:{x:36,y:60}},{head:{x:5,y:-100},neck:{x:4,y:-82},hip:{x:0,y:-2},shoulderL:{x:-14,y:-80},shoulderR:{x:14,y:-80},elbowL:{x:-2,y:-64},elbowR:{x:24,y:-66},handL:{x:12,y:-78},handR:{x:30,y:-80},kneeL:{x:-6,y:26},kneeR:{x:10,y:26},footL:{x:-8,y:60},footR:{x:14,y:60}},{head:{x:8,y:-98},neck:{x:6,y:-80},hip:{x:0,y:0},shoulderL:{x:-12,y:-78},shoulderR:{x:16,y:-78},elbowL:{x:-14,y:-56},elbowR:{x:30,y:-66},handL:{x:-8,y:-42},handR:{x:36,y:-78},kneeL:{x:-26,y:20},kneeR:{x:8,y:26},footL:{x:-36,y:60},footR:{x:14,y:60}},{head:{x:5,y:-100},neck:{x:4,y:-82},hip:{x:0,y:-2},shoulderL:{x:-14,y:-80},shoulderR:{x:14,y:-80},elbowL:{x:-2,y:-64},elbowR:{x:24,y:-66},handL:{x:12,y:-78},handR:{x:30,y:-80},kneeL:{x:-6,y:26},kneeR:{x:10,y:26},footL:{x:-8,y:60},footR:{x:14,y:60}}],WALK_BACKWARD:[{head:{x:-4,y:-96},neck:{x:-3,y:-78},hip:{x:0,y:3},shoulderL:{x:-16,y:-76},shoulderR:{x:12,y:-76},elbowL:{x:-6,y:-62},elbowR:{x:20,y:-66},handL:{x:6,y:-76},handR:{x:26,y:-80},kneeL:{x:-26,y:22},kneeR:{x:6,y:26},footL:{x:-36,y:60},footR:{x:10,y:60}},{head:{x:-2,y:-98},neck:{x:-1,y:-80},hip:{x:0,y:1},shoulderL:{x:-14,y:-78},shoulderR:{x:14,y:-78},elbowL:{x:-4,y:-64},elbowR:{x:24,y:-66},handL:{x:10,y:-78},handR:{x:30,y:-82},kneeL:{x:-10,y:26},kneeR:{x:10,y:26},footL:{x:-14,y:60},footR:{x:14,y:60}},{head:{x:-4,y:-96},neck:{x:-3,y:-78},hip:{x:0,y:3},shoulderL:{x:-16,y:-76},shoulderR:{x:12,y:-76},elbowL:{x:-8,y:-60},elbowR:{x:22,y:-64},handL:{x:8,y:-74},handR:{x:28,y:-78},kneeL:{x:-6,y:26},kneeR:{x:26,y:22},footL:{x:-10,y:60},footR:{x:36,y:60}},{head:{x:-2,y:-98},neck:{x:-1,y:-80},hip:{x:0,y:1},shoulderL:{x:-14,y:-78},shoulderR:{x:14,y:-78},elbowL:{x:-4,y:-64},elbowR:{x:24,y:-66},handL:{x:10,y:-78},handR:{x:30,y:-82},kneeL:{x:-10,y:26},kneeR:{x:10,y:26},footL:{x:-14,y:60},footR:{x:14,y:60}}],JUMP:[{head:{x:0,y:-96},neck:{x:0,y:-78},hip:{x:0,y:0},shoulderL:{x:-14,y:-76},shoulderR:{x:14,y:-76},elbowL:{x:-22,y:-90},elbowR:{x:22,y:-90},handL:{x:-18,y:-105},handR:{x:18,y:-105},kneeL:{x:-20,y:12},kneeR:{x:20,y:12},footL:{x:-26,y:36},footR:{x:26,y:36}},{head:{x:0,y:-102},neck:{x:0,y:-84},hip:{x:0,y:0},shoulderL:{x:-16,y:-82},shoulderR:{x:16,y:-82},elbowL:{x:-34,y:-74},elbowR:{x:34,y:-74},handL:{x:-44,y:-62},handR:{x:44,y:-62},kneeL:{x:-24,y:16},kneeR:{x:24,y:16},footL:{x:-34,y:42},footR:{x:34,y:42}},{head:{x:3,y:-94},neck:{x:2,y:-76},hip:{x:0,y:4},shoulderL:{x:-14,y:-74},shoulderR:{x:14,y:-74},elbowL:{x:-6,y:-62},elbowR:{x:24,y:-64},handL:{x:8,y:-74},handR:{x:30,y:-76},kneeL:{x:-16,y:22},kneeR:{x:16,y:22},footL:{x:-22,y:50},footR:{x:22,y:50}}],PUNCH:[{head:{x:-8,y:-98},neck:{x:-6,y:-80},hip:{x:0,y:3},shoulderL:{x:-20,y:-78},shoulderR:{x:8,y:-78},elbowL:{x:-10,y:-62},elbowR:{x:-6,y:-60},handL:{x:6,y:-76},handR:{x:-12,y:-52},kneeL:{x:-16,y:26},kneeR:{x:20,y:24},footL:{x:-22,y:60},footR:{x:26,y:60}},{head:{x:10,y:-98},neck:{x:8,y:-80},hip:{x:0,y:0},shoulderL:{x:-8,y:-78},shoulderR:{x:22,y:-78},elbowL:{x:-4,y:-62},elbowR:{x:48,y:-76},handL:{x:8,y:-74},handR:{x:72,y:-76},kneeL:{x:-16,y:26},kneeR:{x:18,y:24},footL:{x:-22,y:60},footR:{x:24,y:60}},{head:{x:14,y:-96},neck:{x:10,y:-78},hip:{x:0,y:0},shoulderL:{x:-6,y:-76},shoulderR:{x:24,y:-76},elbowL:{x:-2,y:-60},elbowR:{x:54,y:-74},handL:{x:6,y:-72},handR:{x:82,y:-74},kneeL:{x:-14,y:26},kneeR:{x:20,y:24},footL:{x:-20,y:60},footR:{x:28,y:60}},{head:{x:6,y:-98},neck:{x:4,y:-80},hip:{x:0,y:1},shoulderL:{x:-12,y:-78},shoulderR:{x:16,y:-78},elbowL:{x:-4,y:-62},elbowR:{x:36,y:-66},handL:{x:10,y:-76},handR:{x:44,y:-72},kneeL:{x:-16,y:26},kneeR:{x:18,y:26},footL:{x:-22,y:60},footR:{x:22,y:60}}],KICK:[{head:{x:-6,y:-98},neck:{x:-4,y:-80},hip:{x:0,y:3},shoulderL:{x:-18,y:-78},shoulderR:{x:12,y:-78},elbowL:{x:-34,y:-66},elbowR:{x:28,y:-62},handL:{x:-42,y:-52},handR:{x:34,y:-48},kneeL:{x:-16,y:28},kneeR:{x:28,y:-8},footL:{x:-22,y:60},footR:{x:22,y:8}},{head:{x:-10,y:-96},neck:{x:-8,y:-78},hip:{x:0,y:3},shoulderL:{x:-22,y:-76},shoulderR:{x:8,y:-76},elbowL:{x:-38,y:-62},elbowR:{x:22,y:-58},handL:{x:-46,y:-48},handR:{x:28,y:-44},kneeL:{x:-16,y:28},kneeR:{x:44,y:-10},footL:{x:-22,y:60},footR:{x:68,y:-12}},{head:{x:-18,y:-92},neck:{x:-14,y:-74},hip:{x:0,y:6},shoulderL:{x:-26,y:-72},shoulderR:{x:4,y:-72},elbowL:{x:-42,y:-58},elbowR:{x:16,y:-54},handL:{x:-50,y:-44},handR:{x:22,y:-40},kneeL:{x:-18,y:30},kneeR:{x:48,y:-8},footL:{x:-26,y:60},footR:{x:88,y:-8}},{head:{x:-6,y:-96},neck:{x:-4,y:-78},hip:{x:0,y:3},shoulderL:{x:-18,y:-76},shoulderR:{x:12,y:-76},elbowL:{x:-30,y:-62},elbowR:{x:26,y:-60},handL:{x:-36,y:-50},handR:{x:32,y:-50},kneeL:{x:-16,y:28},kneeR:{x:24,y:18},footL:{x:-22,y:60},footR:{x:34,y:46}}],SPECIAL:[{head:{x:-4,y:-84},neck:{x:-3,y:-66},hip:{x:0,y:14},shoulderL:{x:-18,y:-64},shoulderR:{x:18,y:-64},elbowL:{x:-28,y:-46},elbowR:{x:10,y:-48},handL:{x:-22,y:-32},handR:{x:2,y:-38},kneeL:{x:-22,y:34},kneeR:{x:22,y:34},footL:{x:-28,y:60},footR:{x:26,y:60}},{head:{x:8,y:-98},neck:{x:6,y:-80},hip:{x:0,y:2},shoulderL:{x:-12,y:-78},shoulderR:{x:20,y:-78},elbowL:{x:-6,y:-64},elbowR:{x:42,y:-70},handL:{x:8,y:-76},handR:{x:56,y:-66},kneeL:{x:-18,y:26},kneeR:{x:20,y:22},footL:{x:-24,y:60},footR:{x:28,y:60}},{head:{x:16,y:-100},neck:{x:12,y:-82},hip:{x:0,y:-2},shoulderL:{x:-6,y:-80},shoulderR:{x:24,y:-80},elbowL:{x:0,y:-66},elbowR:{x:54,y:-76},handL:{x:12,y:-78},handR:{x:80,y:-72},kneeL:{x:-22,y:22},kneeR:{x:24,y:18},footL:{x:-30,y:60},footR:{x:34,y:60}},{head:{x:6,y:-98},neck:{x:4,y:-80},hip:{x:0,y:2},shoulderL:{x:-12,y:-78},shoulderR:{x:16,y:-78},elbowL:{x:-6,y:-62},elbowR:{x:34,y:-64},handL:{x:8,y:-74},handR:{x:42,y:-60},kneeL:{x:-18,y:26},kneeR:{x:18,y:26},footL:{x:-24,y:60},footR:{x:22,y:60}}],BLOCK:[{head:{x:-8,y:-92},neck:{x:-6,y:-74},hip:{x:0,y:8},shoulderL:{x:-14,y:-72},shoulderR:{x:12,y:-72},elbowL:{x:-2,y:-62},elbowR:{x:8,y:-62},handL:{x:10,y:-82},handR:{x:14,y:-54},kneeL:{x:-20,y:30},kneeR:{x:20,y:30},footL:{x:-26,y:60},footR:{x:24,y:60}}],HIT:[{head:{x:-18,y:-94},neck:{x:-14,y:-76},hip:{x:0,y:6},shoulderL:{x:-24,y:-74},shoulderR:{x:2,y:-74},elbowL:{x:-40,y:-58},elbowR:{x:-12,y:-54},handL:{x:-48,y:-42},handR:{x:-20,y:-38},kneeL:{x:-6,y:28},kneeR:{x:18,y:26},footL:{x:-10,y:60},footR:{x:24,y:60}},{head:{x:-12,y:-96},neck:{x:-10,y:-78},hip:{x:0,y:4},shoulderL:{x:-20,y:-76},shoulderR:{x:8,y:-76},elbowL:{x:-34,y:-60},elbowR:{x:-2,y:-56},handL:{x:-38,y:-46},handR:{x:-8,y:-42},kneeL:{x:-12,y:28},kneeR:{x:16,y:28},footL:{x:-16,y:60},footR:{x:22,y:60}}],KO:[{head:{x:-22,y:-88},neck:{x:-16,y:-70},hip:{x:0,y:8},shoulderL:{x:-26,y:-68},shoulderR:{x:0,y:-68},elbowL:{x:-40,y:-52},elbowR:{x:-12,y:-48},handL:{x:-48,y:-36},handR:{x:-20,y:-32},kneeL:{x:-4,y:30},kneeR:{x:20,y:28},footL:{x:-8,y:60},footR:{x:28,y:60}},{head:{x:-34,y:-55},neck:{x:-26,y:-40},hip:{x:0,y:24},shoulderL:{x:-30,y:-36},shoulderR:{x:-18,y:-34},elbowL:{x:-42,y:-20},elbowR:{x:-14,y:-18},handL:{x:-50,y:-4},handR:{x:-10,y:0},kneeL:{x:10,y:40},kneeR:{x:26,y:38},footL:{x:18,y:58},footR:{x:38,y:56}},{head:{x:-44,y:34},neck:{x:-32,y:38},hip:{x:0,y:46},shoulderL:{x:-36,y:36},shoulderR:{x:-28,y:40},elbowL:{x:-48,y:44},elbowR:{x:-18,y:46},handL:{x:-58,y:50},handR:{x:-12,y:52},kneeL:{x:20,y:42},kneeR:{x:30,y:46},footL:{x:38,y:48},footR:{x:50,y:52}}],VICTORY:[{head:{x:0,y:-104},neck:{x:0,y:-86},hip:{x:0,y:-4},shoulderL:{x:-16,y:-84},shoulderR:{x:16,y:-84},elbowL:{x:-24,y:-100},elbowR:{x:24,y:-100},handL:{x:-20,y:-116},handR:{x:20,y:-116},kneeL:{x:-14,y:24},kneeR:{x:14,y:24},footL:{x:-20,y:60},footR:{x:20,y:60}},{head:{x:0,y:-106},neck:{x:0,y:-88},hip:{x:0,y:-6},shoulderL:{x:-18,y:-86},shoulderR:{x:18,y:-86},elbowL:{x:-30,y:-106},elbowR:{x:30,y:-106},handL:{x:-34,y:-122},handR:{x:34,y:-122},kneeL:{x:-16,y:22},kneeR:{x:16,y:22},footL:{x:-22,y:60},footR:{x:22,y:60}},{head:{x:0,y:-104},neck:{x:0,y:-86},hip:{x:0,y:-2},shoulderL:{x:-18,y:-84},shoulderR:{x:18,y:-84},elbowL:{x:-36,y:-98},elbowR:{x:36,y:-98},handL:{x:-44,y:-112},handR:{x:44,y:-112},kneeL:{x:-18,y:24},kneeR:{x:18,y:24},footL:{x:-26,y:60},footR:{x:26,y:60}}]};function z(o,e,t){const i={};for(const s in o)i[s]={x:o[s].x+(e[s].x-o[s].x)*t,y:o[s].y+(e[s].y-o[s].y)*t};return i}let I=null;function L(){return I||(I=new(window.AudioContext||window.webkitAudioContext)),I.state==="suspended"&&I.resume(),I}function u(o,e,t="square",i=.15,s=!0){const a=L(),n=a.createOscillator(),h=a.createGain();n.type=t,n.frequency.value=o,h.gain.value=i,s&&h.gain.exponentialRampToValueAtTime(.001,a.currentTime+e),n.connect(h),h.connect(a.destination),n.start(a.currentTime),n.stop(a.currentTime+e)}function k(o,e=.1){const t=L(),i=t.sampleRate*o,s=t.createBuffer(1,i,t.sampleRate),a=s.getChannelData(0);for(let c=0;c<i;c++)a[c]=Math.random()*2-1;const n=t.createBufferSource();n.buffer=s;const h=t.createGain();h.gain.value=e,h.gain.exponentialRampToValueAtTime(.001,t.currentTime+o);const r=t.createBiquadFilter();r.type="bandpass",r.frequency.value=1e3,r.Q.value=.5,n.connect(r),r.connect(h),h.connect(t.destination),n.start(t.currentTime)}const p={punch(){u(200,.08,"square",.12),k(.06,.1)},kick(){u(140,.12,"square",.15),k(.1,.12),u(80,.1,"sine",.2)},special(){const o=L(),e=o.createOscillator(),t=o.createGain();e.type="sawtooth",e.frequency.value=150,e.frequency.exponentialRampToValueAtTime(600,o.currentTime+.2),t.gain.value=.12,t.gain.exponentialRampToValueAtTime(.001,o.currentTime+.3),e.connect(t),t.connect(o.destination),e.start(o.currentTime),e.stop(o.currentTime+.3),k(.15,.1)},block(){u(400,.06,"triangle",.08),u(300,.08,"triangle",.06)},hit(){u(160,.1,"square",.15),k(.08,.15),u(60,.15,"sine",.2)},ko(){const o=L(),e=o.createOscillator(),t=o.createGain();e.type="sawtooth",e.frequency.value=400,e.frequency.exponentialRampToValueAtTime(50,o.currentTime+.8),t.gain.value=.15,t.gain.exponentialRampToValueAtTime(.001,o.currentTime+.8),e.connect(t),t.connect(o.destination),e.start(o.currentTime),e.stop(o.currentTime+.8),k(.4,.12)},roundStart(){u(440,.1,"square",.08),setTimeout(()=>u(440,.1,"square",.08),200),setTimeout(()=>u(880,.2,"square",.1),400)},menuSelect(){u(660,.08,"square",.08),setTimeout(()=>u(880,.1,"square",.1),60)},victory(){[523,659,784,1047].forEach((e,t)=>{setTimeout(()=>u(e,.2,"square",.1),t*150)})},jump(){const o=L(),e=o.createOscillator(),t=o.createGain();e.type="sine",e.frequency.value=250,e.frequency.exponentialRampToValueAtTime(500,o.currentTime+.1),t.gain.value=.06,t.gain.exponentialRampToValueAtTime(.001,o.currentTime+.12),e.connect(t),t.connect(o.destination),e.start(o.currentTime),e.stop(o.currentTime+.12)},land(){u(80,.06,"sine",.08)},whoosh(){k(.1,.04)},boom(){const o=L(),e=o.createOscillator(),t=o.createGain();e.type="sine",e.frequency.value=60,e.frequency.exponentialRampToValueAtTime(20,o.currentTime+.4),t.gain.value=.25,t.gain.exponentialRampToValueAtTime(.001,o.currentTime+.4),e.connect(t),t.connect(o.destination),e.start(o.currentTime),e.stop(o.currentTime+.4),k(.3,.18)},warp(){const o=L(),e=o.createOscillator(),t=o.createGain();e.type="sine",e.frequency.value=800,e.frequency.exponentialRampToValueAtTime(100,o.currentTime+.15),t.gain.value=.1,t.gain.exponentialRampToValueAtTime(.001,o.currentTime+.15),e.connect(t),t.connect(o.destination),e.start(o.currentTime),e.stop(o.currentTime+.15),setTimeout(()=>{const i=o.createOscillator(),s=o.createGain();i.type="sine",i.frequency.value=100,i.frequency.exponentialRampToValueAtTime(600,o.currentTime+.1),s.gain.value=.1,s.gain.exponentialRampToValueAtTime(.001,o.currentTime+.12),i.connect(s),s.connect(o.destination),i.start(o.currentTime),i.stop(o.currentTime+.12)},100)},electric(){const o=L();for(let e=0;e<4;e++)setTimeout(()=>{const t=o.createOscillator(),i=o.createGain();t.type="square",t.frequency.value=800+Math.random()*1200,i.gain.value=.06,i.gain.exponentialRampToValueAtTime(.001,o.currentTime+.05),t.connect(i),i.connect(o.destination),t.start(o.currentTime),t.stop(o.currentTime+.05)},e*30);k(.12,.08)},heavyImpact(){u(50,.2,"sine",.25),u(100,.15,"square",.12),k(.12,.15)},iceSlide(){const o=L(),e=o.createOscillator(),t=o.createGain();e.type="triangle",e.frequency.value=1200,e.frequency.exponentialRampToValueAtTime(400,o.currentTime+.2),t.gain.value=.06,t.gain.exponentialRampToValueAtTime(.001,o.currentTime+.25),e.connect(t),t.connect(o.destination),e.start(o.currentTime),e.stop(o.currentTime+.25),k(.15,.04)},flurryHit(){u(300+Math.random()*200,.04,"square",.08),k(.03,.06)},risingAttack(){const o=L(),e=o.createOscillator(),t=o.createGain();e.type="sawtooth",e.frequency.value=200,e.frequency.exponentialRampToValueAtTime(800,o.currentTime+.15),t.gain.value=.1,t.gain.exponentialRampToValueAtTime(.001,o.currentTime+.2),e.connect(t),t.connect(o.destination),e.start(o.currentTime),e.stop(o.currentTime+.2)}};class J extends f.Scene{constructor(){super("TitleScene")}create(){this.add.text(640,160,"STICK FIGHTER",{fontSize:"72px",fontFamily:"monospace",color:"#ffffff",fontStyle:"bold"}).setOrigin(.5),this.add.text(640,240,"A game of sticks and honor",{fontSize:"20px",fontFamily:"monospace",color:"#888888"}).setOrigin(.5);const e=this.add.graphics();new T(e).draw(440,480,w.IDLE[0],!0,16777215);const i=this.add.graphics();new T(i).draw(840,480,w.IDLE[0],!1,65535),this.add.text(640,560,"P1: WASD + J/K/L    P2: Arrows + , . /",{fontSize:"16px",fontFamily:"monospace",color:"#666666"}).setOrigin(.5),this.add.text(640,585,"Gamepads supported!",{fontSize:"14px",fontFamily:"monospace",color:"#555555"}).setOrigin(.5),this.promptText=this.add.text(640,650,"Press ENTER or SPACE to fight!",{fontSize:"24px",fontFamily:"monospace",color:"#ffcc00"}).setOrigin(.5),this.tweens.add({targets:this.promptText,alpha:.3,duration:600,yoyo:!0,repeat:-1}),this.input.keyboard.on("keydown-ENTER",this.startGame,this),this.input.keyboard.on("keydown-SPACE",this.startGame,this),this.input.gamepad.on("down",(a,n)=>{this.startGame()})}startGame(){p.menuSelect(),this.scene.start("CharacterSelectScene")}}const R=[{id:"swift",name:"Swift",color:16777215,description:"Balanced fighter with a quick lunge.",moveSpeed:300,jumpVelocity:-650,punchDamage:8,punchRange:60,kickDamage:14,kickRange:80,specialDamage:22,specialRange:100,specialType:"lunge",specialName:"Dash Strike",specialDuration:500},{id:"titan",name:"Titan",color:65535,description:"Slow powerhouse. Ground pound shakes the arena.",moveSpeed:220,jumpVelocity:-520,punchDamage:11,punchRange:65,kickDamage:19,kickRange:85,specialDamage:28,specialRange:120,specialType:"groundPound",specialName:"Ground Pound",specialDuration:900},{id:"shadow",name:"Shadow",color:12272895,description:"Fragile but lightning fast. Teleports behind foes.",moveSpeed:380,jumpVelocity:-700,punchDamage:7,punchRange:55,kickDamage:12,kickRange:75,specialDamage:18,specialRange:60,specialType:"teleport",specialName:"Shadow Step",specialDuration:550,maxHealth:80},{id:"blaze",name:"Blaze",color:16737792,description:"Aggressive brawler with a fiery uppercut.",moveSpeed:280,jumpVelocity:-620,punchDamage:9,punchRange:58,kickDamage:15,kickRange:78,specialDamage:24,specialRange:70,specialType:"uppercut",specialName:"Fire Uppercut",specialDuration:650},{id:"frost",name:"Frost",color:6737151,description:"Cool and collected. Ice slide covers distance fast.",moveSpeed:260,jumpVelocity:-600,punchDamage:8,punchRange:60,kickDamage:14,kickRange:80,specialDamage:20,specialRange:130,specialType:"slide",specialName:"Ice Slide",specialDuration:550},{id:"thunder",name:"Thunder",color:16776960,description:"Electrifying strikes. Lightning drop from above.",moveSpeed:270,jumpVelocity:-680,punchDamage:9,punchRange:60,kickDamage:16,kickRange:82,specialDamage:26,specialRange:90,specialType:"lightningDrop",specialName:"Lightning Drop",specialDuration:800},{id:"viper",name:"Viper",color:4521796,description:"Quick multi-hit combos. Rapid dash flurry.",moveSpeed:330,jumpVelocity:-640,punchDamage:6,punchRange:55,kickDamage:10,kickRange:70,specialDamage:8,specialRange:80,specialType:"flurry",specialName:"Viper Flurry",specialHits:4,specialDuration:700},{id:"golem",name:"Golem",color:11176021,description:"Immovable wall. Absorbs a hit during special.",moveSpeed:180,jumpVelocity:-450,punchDamage:13,punchRange:70,kickDamage:22,kickRange:90,specialDamage:30,specialRange:90,specialType:"armorSmash",specialName:"Armor Smash",specialDuration:800,maxHealth:120},{id:"phantom",name:"Phantom",color:14540287,description:"Floaty and evasive. Spinning whirlwind attack.",moveSpeed:290,jumpVelocity:-750,punchDamage:7,punchRange:55,kickDamage:12,kickRange:75,specialDamage:16,specialRange:110,specialType:"whirlwind",specialName:"Whirlwind",specialDuration:650},{id:"nova",name:"Nova",color:16724838,description:"Glass cannon. Massive explosive burst.",moveSpeed:260,jumpVelocity:-600,punchDamage:10,punchRange:58,kickDamage:16,kickRange:78,specialDamage:38,specialRange:140,specialType:"explosion",specialName:"Nova Burst",specialDuration:700,maxHealth:70}],g=5,E=2,m=200,S=180,P=140,_=120;class q extends f.Scene{constructor(){super("CharacterSelectScene")}create(){this.p1Index=0,this.p2Index=1,this.p1Locked=!1,this.p2Locked=!1,this.add.text(640,40,"SELECT YOUR FIGHTER",{fontSize:"36px",fontFamily:"monospace",color:"#ffffff",fontStyle:"bold"}).setOrigin(.5),this.add.text(640,80,"P1: WASD + J to lock    P2: Arrows + , to lock",{fontSize:"14px",fontFamily:"monospace",color:"#666666"}).setOrigin(.5),this.cellGraphics=[],this.cellTexts=[];for(let e=0;e<R.length;e++){const t=e%g,i=Math.floor(e/g),s=P+t*m+m/2,a=_+i*S+S/2,n=R[e],h=this.add.graphics();this.cellGraphics.push(h);const r=this.add.text(s,a+50,n.name,{fontSize:"14px",fontFamily:"monospace",color:"#aaaaaa"}).setOrigin(.5);this.cellTexts.push(r);const c=this.add.graphics();new T(c).draw(s,a+20,w.IDLE[0],!0,n.color)}this.p1Info=this.add.text(200,520,"",{fontSize:"16px",fontFamily:"monospace",color:"#ffffff",wordWrap:{width:350}}).setOrigin(.5,0),this.p2Info=this.add.text(1080,520,"",{fontSize:"16px",fontFamily:"monospace",color:"#ffffff",wordWrap:{width:350}}).setOrigin(.5,0),this.add.text(200,495,"PLAYER 1",{fontSize:"20px",fontFamily:"monospace",color:"#ffcc00",fontStyle:"bold"}).setOrigin(.5),this.add.text(1080,495,"PLAYER 2",{fontSize:"20px",fontFamily:"monospace",color:"#ffcc00",fontStyle:"bold"}).setOrigin(.5),this.p1LockText=this.add.text(200,660,"",{fontSize:"18px",fontFamily:"monospace",color:"#00ff00"}).setOrigin(.5),this.p2LockText=this.add.text(1080,660,"",{fontSize:"18px",fontFamily:"monospace",color:"#00ff00"}).setOrigin(.5),this.startText=this.add.text(640,690,"",{fontSize:"20px",fontFamily:"monospace",color:"#ffcc00"}).setOrigin(.5),this.highlightGraphics=this.add.graphics(),this.highlightGraphics.setDepth(50),this.p1Keys={up:this.input.keyboard.addKey("W"),down:this.input.keyboard.addKey("S"),left:this.input.keyboard.addKey("A"),right:this.input.keyboard.addKey("D"),confirm:this.input.keyboard.addKey("J"),cancel:this.input.keyboard.addKey("K")},this.p2Keys={up:this.input.keyboard.addKey("UP"),down:this.input.keyboard.addKey("DOWN"),left:this.input.keyboard.addKey("LEFT"),right:this.input.keyboard.addKey("RIGHT"),confirm:this.input.keyboard.addKey("COMMA"),cancel:this.input.keyboard.addKey("PERIOD")},this.p1PadPrev={},this.p2PadPrev={},this.updateDisplay()}update(){this.p1Locked?(f.Input.Keyboard.JustDown(this.p1Keys.cancel)||this.padJustPressed(1,"B"))&&this.unlock(1):((f.Input.Keyboard.JustDown(this.p1Keys.left)||this.padJustPressed(1,"left"))&&this.moveSelection(1,-1,0),(f.Input.Keyboard.JustDown(this.p1Keys.right)||this.padJustPressed(1,"right"))&&this.moveSelection(1,1,0),(f.Input.Keyboard.JustDown(this.p1Keys.up)||this.padJustPressed(1,"up"))&&this.moveSelection(1,0,-1),(f.Input.Keyboard.JustDown(this.p1Keys.down)||this.padJustPressed(1,"down"))&&this.moveSelection(1,0,1),(f.Input.Keyboard.JustDown(this.p1Keys.confirm)||this.padJustPressed(1,"A"))&&this.lockIn(1)),this.p2Locked?(f.Input.Keyboard.JustDown(this.p2Keys.cancel)||this.padJustPressed(2,"B"))&&this.unlock(2):((f.Input.Keyboard.JustDown(this.p2Keys.left)||this.padJustPressed(2,"left"))&&this.moveSelection(2,-1,0),(f.Input.Keyboard.JustDown(this.p2Keys.right)||this.padJustPressed(2,"right"))&&this.moveSelection(2,1,0),(f.Input.Keyboard.JustDown(this.p2Keys.up)||this.padJustPressed(2,"up"))&&this.moveSelection(2,0,-1),(f.Input.Keyboard.JustDown(this.p2Keys.down)||this.padJustPressed(2,"down"))&&this.moveSelection(2,0,1),(f.Input.Keyboard.JustDown(this.p2Keys.confirm)||this.padJustPressed(2,"A"))&&this.lockIn(2)),this.updatePadPrev()}getPad(e){if(!this.input.gamepad)return null;const t=this.input.gamepad.gamepads.filter(s=>s&&s.connected),i=e-1;return t.find(s=>s.index===i)||null}padJustPressed(e,t){const i=this.getPad(e),s=e===1?this.p1PadPrev:this.p2PadPrev;if(!i)return!1;const a=.5,n=i.leftStick?i.leftStick.x:0,h=i.leftStick?i.leftStick.y:0;let r=!1;switch(t){case"left":r=i.left||n<-a;break;case"right":r=i.right||n>a;break;case"up":r=i.up||h<-a;break;case"down":r=i.down||h>a;break;case"A":r=i.A;break;case"B":r=i.B;break}return r&&!s[t]}updatePadPrev(){for(const e of[1,2]){const t=this.getPad(e),i=e===1?this.p1PadPrev:this.p2PadPrev;if(!t)continue;const s=.5,a=t.leftStick?t.leftStick.x:0,n=t.leftStick?t.leftStick.y:0;i.left=t.left||a<-s,i.right=t.right||a>s,i.up=t.up||n<-s,i.down=t.down||n>s,i.A=t.A,i.B=t.B}}moveSelection(e,t,i){const s=e===1?this.p1Index:this.p2Index;let a=s%g,n=Math.floor(s/g);a+=t,n+=i,a<0&&(a=g-1),a>=g&&(a=0),n<0&&(n=E-1),n>=E&&(n=0);const h=n*g+a;h>=0&&h<R.length&&(e===1?this.p1Index=h:this.p2Index=h,p.menuSelect(),this.updateDisplay())}lockIn(e){e===1?this.p1Locked=!0:this.p2Locked=!0,p.roundStart(),this.updateDisplay(),this.p1Locked&&this.p2Locked&&this.time.delayedCall(500,()=>this.startFight())}unlock(e){e===1?this.p1Locked=!1:this.p2Locked=!1,p.block(),this.updateDisplay()}updateDisplay(){const e=this.highlightGraphics;e.clear();for(let b=0;b<R.length;b++){const D=b%g,K=Math.floor(b/g),O=P+D*m,H=_+K*S,C=this.cellGraphics[b];C.clear(),C.fillStyle(1710654,.6),C.fillRect(O+4,H+4,m-8,S-8),C.lineStyle(1,3355494,.8),C.strokeRect(O+4,H+4,m-8,S-8)}const t=this.p1Index%g,i=Math.floor(this.p1Index/g),s=P+t*m,a=_+i*S;e.lineStyle(3,this.p1Locked?65280:16763904,1),e.strokeRect(s+2,a+2,m-4,S-4),e.fillStyle(this.p1Locked?65280:16763904,1),e.fillTriangle(s+10,a+8,s+22,a+8,s+16,a+18),e.fillStyle(0,1),this.add.text;const n=this.p2Index%g,h=Math.floor(this.p2Index/g),r=P+n*m,c=_+h*S;e.lineStyle(3,this.p2Locked?65280:52479,1),e.strokeRect(r+6,c+6,m-12,S-12),e.fillStyle(this.p2Locked?65280:52479,1),e.fillTriangle(r+m-10,c+8,r+m-22,c+8,r+m-16,c+18);const y=R[this.p1Index],x=R[this.p2Index];this.p1Info.setText(`${y.name}
${y.description}

SPD: ${"|".repeat(Math.round(y.moveSpeed/40))}  HP: ${y.maxHealth||100}
Special: ${y.specialName}`),this.p1Info.setColor(`#${y.color.toString(16).padStart(6,"0")}`),this.p2Info.setText(`${x.name}
${x.description}

SPD: ${"|".repeat(Math.round(x.moveSpeed/40))}  HP: ${x.maxHealth||100}
Special: ${x.specialName}`),this.p2Info.setColor(`#${x.color.toString(16).padStart(6,"0")}`),this.p1LockText.setText(this.p1Locked?"LOCKED IN!":""),this.p2LockText.setText(this.p2Locked?"LOCKED IN!":""),this.p1Locked&&this.p2Locked?this.startText.setText("GET READY..."):this.startText.setText("")}startFight(){this.registry.set("p1Fighter",this.p1Index),this.registry.set("p2Fighter",this.p2Index),this.registry.set("p1Wins",0),this.registry.set("p2Wins",0),this.registry.set("currentRound",1),this.scene.start("FightScene")}}function j(o,e,t,i,s,a=5){const n=o.add.graphics().setDepth(8);for(let h=0;h<a;h++){const r=t-30+Math.random()*60,c=e-i*(10+h*12),y=20+Math.random()*25;n.lineStyle(2,s,.6-h*.08),n.lineBetween(c,r,c-i*y,r)}o.tweens.add({targets:n,alpha:0,duration:200,onComplete:()=>n.destroy()})}function A(o,e,t,i=11184810){const s=o.add.graphics().setDepth(8);for(let a=0;a<6;a++){const n=Math.random()*Math.PI*2,h=5+Math.random()*15,r=3+Math.random()*4;s.fillStyle(i,.4),s.fillCircle(e+Math.cos(n)*h,t+Math.sin(n)*h,r)}o.tweens.add({targets:s,alpha:0,duration:400,onComplete:()=>s.destroy()})}function M(o,e,t,i,s=80){const a=o.add.graphics().setDepth(12);o.tweens.addCounter({from:10,to:s,duration:400,onUpdate:n=>{a.clear();const h=n.getValue(),r=(h-10)/(s-10);a.lineStyle(3,i,(1-r)*.8),a.strokeCircle(e,t,h),a.lineStyle(2,16777215,(1-r)*.4),a.strokeCircle(e,t,h*.6)},onComplete:()=>a.destroy()})}function $(o,e,t,i=16737792,s=8){const a=o.add.graphics().setDepth(8),n=[];for(let h=0;h<s;h++)n.push({x:e+(Math.random()-.5)*20,y:t+(Math.random()-.5)*20,vx:(Math.random()-.5)*80,vy:-100-Math.random()*150,size:2+Math.random()*4});o.tweens.addCounter({from:0,to:1,duration:500,onUpdate:h=>{a.clear();const r=h.getValue();n.forEach(c=>{c.x+=c.vx*.016,c.y+=c.vy*.016,c.vy+=120*.016,a.fillStyle(i,1-r),a.fillCircle(c.x,c.y,c.size*(1-r*.5)),a.fillStyle(16776960,(1-r)*.5),a.fillCircle(c.x,c.y,c.size*.4)})},onComplete:()=>a.destroy()})}function Z(o,e,t,i,s=16737792){const a=o.add.graphics().setDepth(7);for(let n=0;n<4;n++){const h=e-i*(n*8)+(Math.random()-.5)*10,r=t+(Math.random()-.5)*15,c=3+Math.random()*5;a.fillStyle(s,.6),a.fillCircle(h,r,c),a.fillStyle(16777028,.3),a.fillCircle(h,r,c*.5)}o.tweens.add({targets:a,alpha:0,duration:250,onComplete:()=>a.destroy()})}function Q(o,e,t,i,s=6737151){const a=o.add.graphics().setDepth(5);for(let n=0;n<6;n++){const h=e-i*n*18+(Math.random()-.5)*8,r=t+(Math.random()-.5)*6,c=3+Math.random()*5;a.fillStyle(s,.6),a.fillTriangle(h,r-c,h-c*.6,r,h+c*.6,r),a.fillTriangle(h,r+c,h-c*.6,r,h+c*.6,r),a.fillStyle(16777215,.3),a.fillCircle(h,r-c*.3,1.5)}o.tweens.add({targets:a,alpha:0,duration:600,onComplete:()=>a.destroy()})}function ee(o,e,t,i=6737151){const s=o.add.graphics().setDepth(12),a=[];for(let n=0;n<6;n++){const h=Math.random()*Math.PI*2,r=60+Math.random()*100;a.push({x:e,y:t,vx:Math.cos(h)*r,vy:Math.sin(h)*r-40,size:2+Math.random()*3})}o.tweens.addCounter({from:0,to:1,duration:400,onUpdate:n=>{s.clear();const h=n.getValue();a.forEach(r=>{r.x+=r.vx*.016,r.y+=r.vy*.016,s.fillStyle(i,1-h),s.fillCircle(r.x,r.y,r.size)})},onComplete:()=>s.destroy()})}function te(o,e,t,i,s,a=16776960){const n=o.add.graphics().setDepth(15),h=8,r=[{x:e,y:t}];for(let c=1;c<h;c++){const y=c/h;r.push({x:e+(i-e)*y+(Math.random()-.5)*40,y:t+(s-t)*y+(Math.random()-.5)*10})}r.push({x:i,y:s}),n.lineStyle(8,a,.3);for(let c=0;c<r.length-1;c++)n.lineBetween(r[c].x,r[c].y,r[c+1].x,r[c+1].y);n.lineStyle(3,a,1);for(let c=0;c<r.length-1;c++)n.lineBetween(r[c].x,r[c].y,r[c+1].x,r[c+1].y);n.lineStyle(1,16777215,.9);for(let c=0;c<r.length-1;c++)n.lineBetween(r[c].x,r[c].y,r[c+1].x,r[c+1].y);o.tweens.add({targets:n,alpha:0,duration:150,onComplete:()=>n.destroy()})}function v(o,e,t,i=16776960,s=10){const a=o.add.graphics().setDepth(12),n=[];for(let h=0;h<s;h++){const r=Math.random()*Math.PI*2,c=100+Math.random()*200;n.push({x:e,y:t,vx:Math.cos(r)*c,vy:Math.sin(r)*c-50,len:4+Math.random()*8})}o.tweens.addCounter({from:0,to:1,duration:300,onUpdate:h=>{a.clear();const r=h.getValue();n.forEach(c=>{c.x+=c.vx*.016,c.y+=c.vy*.016;const y=Math.atan2(c.vy,c.vx);a.lineStyle(2,i,1-r),a.lineBetween(c.x,c.y,c.x-Math.cos(y)*c.len,c.y-Math.sin(y)*c.len)})},onComplete:()=>a.destroy()})}function ie(o,e,t,i,s=4521796){const a=o.add.graphics().setDepth(12),n=e+i*35,h=Math.random()*.5-.25,r=20+Math.random()*15;a.lineStyle(3,s,.9),a.lineBetween(n-Math.cos(h)*r,t-Math.sin(h)*r,n+Math.cos(h)*r,t+Math.sin(h)*r),a.lineStyle(1,16777215,.6),a.lineBetween(n-Math.cos(h)*r,t-Math.sin(h)*r,n+Math.cos(h)*r,t+Math.sin(h)*r),o.tweens.add({targets:a,alpha:0,duration:120,onComplete:()=>a.destroy()})}function se(o,e,t,i=11176021,s=40){const a=o.add.graphics().setDepth(7);a.fillStyle(i,.15),a.fillCircle(e,t,s),a.lineStyle(3,i,.6),a.strokeCircle(e,t,s),a.lineStyle(6,i,.2),a.strokeCircle(e,t,s+5),o.tweens.add({targets:a,alpha:0,duration:200,onComplete:()=>a.destroy()})}function ae(o,e,t,i,s=14540287){const a=o.add.graphics().setDepth(8),n=40;for(let h=0;h<3;h++){const r=i+h*Math.PI*2/3;a.lineStyle(3,s,.7),a.beginPath(),a.arc(e,t,n+h*6,r,r+Math.PI*.6),a.strokePath()}for(let h=0;h<4;h++){const r=i*.5+h*Math.PI/2,c=n+12+Math.random()*10;a.fillStyle(11184810,.3),a.fillCircle(e+Math.cos(r)*c,t+Math.sin(r)*c,2)}o.tweens.add({targets:a,alpha:0,duration:120,onComplete:()=>a.destroy()})}function ne(o,e,t,i,s){const a=o.add.graphics().setDepth(8);a.fillStyle(i,.15),a.fillCircle(e,t,s),a.lineStyle(2,i,.5),a.strokeCircle(e,t,s),a.fillStyle(16777215,.2),a.fillCircle(e,t,s*.3),o.tweens.add({targets:a,alpha:0,duration:80,onComplete:()=>a.destroy()})}function oe(o,e,t,i,s=120){const a=o.add.graphics().setDepth(100);a.fillStyle(i,.3),a.fillRect(0,0,1280,720),o.tweens.add({targets:a,alpha:0,duration:200,onComplete:()=>a.destroy()});const n=o.add.graphics().setDepth(15);o.tweens.addCounter({from:5,to:s,duration:400,onUpdate:h=>{n.clear();const r=h.getValue(),c=(r-5)/(s-5);n.lineStyle(4,i,(1-c)*.9),n.strokeCircle(e,t,r),n.lineStyle(2,16777215,(1-c)*.6),n.strokeCircle(e,t,r*.7);for(let y=0;y<8;y++){const x=y/8*Math.PI*2+c*3;n.fillStyle(i,(1-c)*.7),n.fillCircle(e+Math.cos(x)*r,t+Math.sin(x)*r,3)}},onComplete:()=>n.destroy()})}function he(o,e,t,i=12272895){const s=o.add.graphics().setDepth(12);o.tweens.addCounter({from:0,to:1,duration:400,onUpdate:a=>{s.clear();const n=a.getValue();for(let h=0;h<8;h++){const r=h/8*Math.PI*2,c=n*25,y=6+n*8;s.fillStyle(i,(1-n)*.5),s.fillCircle(e+Math.cos(r)*c,t+Math.sin(r)*c,y*(1-n*.3))}},onComplete:()=>s.destroy()})}function re(o,e,t,i=12272895){const s=o.add.graphics().setDepth(15);s.fillStyle(16777215,.8),s.fillCircle(e,t,15),s.fillStyle(i,.5),s.fillCircle(e,t,30);for(let a=0;a<6;a++){const n=a/6*Math.PI*2;s.lineStyle(2,i,.7),s.lineBetween(e,t,e+Math.cos(n)*35,t+Math.sin(n)*35)}o.tweens.add({targets:s,alpha:0,duration:250,onComplete:()=>s.destroy()})}function B(o,e,t,i=8947848){const s=o.add.graphics().setDepth(3);for(let a=0;a<5;a++){const n=-Math.PI*.8+a/4*Math.PI*.6,h=25+Math.random()*35,r=e+Math.cos(n)*h*.5+(Math.random()-.5)*8,c=t+Math.abs(Math.sin(n))*h*.2,y=e+Math.cos(n)*h+(Math.random()-.5)*12,x=t+Math.abs(Math.sin(n))*h*.15;s.lineStyle(2,i,.7),s.lineBetween(e,t,r,c),s.lineBetween(r,c,y,x)}o.tweens.add({targets:s,alpha:0,duration:1200,onComplete:()=>s.destroy()})}const l={IDLE:"IDLE",WALK_FORWARD:"WALK_FORWARD",WALK_BACKWARD:"WALK_BACKWARD",JUMP:"JUMP",PUNCH:"PUNCH",KICK:"KICK",SPECIAL:"SPECIAL",BLOCK:"BLOCK",HIT:"HIT",KO:"KO",VICTORY:"VICTORY"};class N{constructor(e,t,i,s,a,n){this.scene=e,this.playerIndex=s,this.facingRight=a,this.data=n,this.state=l.IDLE,this.maxHealth=n.maxHealth||d.MAX_HEALTH,this.health=this.maxHealth,this.stateTimer=0,this.specialCooldown=0,this.canAct=!0,this.hasHit=!1,this.specialHitCount=0,this.armorActive=!1,this._effectPhase=0,this._effectTimer=0,this.body=e.add.zone(t,i-d.BODY_HEIGHT/2,d.BODY_WIDTH,d.BODY_HEIGHT),e.physics.add.existing(this.body),this.body.body.setCollideWorldBounds(!0),this.graphics=e.add.graphics(),this.graphics.setDepth(10),this.renderer=new T(this.graphics),this.animFrame=0,this.animTimer=0}get x(){return this.body.x}get y(){return this.body.y}get isGrounded(){return this.body.body.blocked.down}get specialDuration(){return this.data.specialDuration||d.SPECIAL_DURATION}update(e,t){this.stateTimer+=e,this.animTimer+=e,this.specialCooldown=Math.max(0,this.specialCooldown-e),this.canAct&&this.state!==l.KO&&this.state!==l.VICTORY&&this.handleInput(t),this.updateState(e),this.draw()}handleInput(e){if(!this.canAct)return;const t=[l.IDLE,l.WALK_FORWARD,l.WALK_BACKWARD,l.BLOCK].includes(this.state),i=!this.isGrounded;if(t||i&&this.state===l.JUMP){if(e.special&&this.specialCooldown<=0&&this.isGrounded){this.enterState(l.SPECIAL),this.specialCooldown=d.SPECIAL_COOLDOWN;return}if(e.punch){this.enterState(l.PUNCH);return}if(e.kick){this.enterState(l.KICK);return}}if(e.block&&this.isGrounded&&t){this.state!==l.BLOCK&&this.enterState(l.BLOCK);return}if(this.state===l.BLOCK&&!e.block&&this.enterState(l.IDLE),e.jump&&this.isGrounded&&t){this.body.body.setVelocityY(this.data.jumpVelocity),this.enterState(l.JUMP);return}if(this.state!==l.BLOCK&&this.state!==l.JUMP)if(e.left){if(this.body.body.setVelocityX(-this.data.moveSpeed),this.isGrounded){const s=!this.facingRight;this.state=s?l.WALK_FORWARD:l.WALK_BACKWARD}}else if(e.right){if(this.body.body.setVelocityX(this.data.moveSpeed),this.isGrounded){const s=this.facingRight;this.state=s?l.WALK_FORWARD:l.WALK_BACKWARD}}else this.isGrounded&&t&&(this.body.body.setVelocityX(0),this.state!==l.IDLE&&(this.state=l.IDLE));this.state===l.JUMP&&(e.left?this.body.body.setVelocityX(-this.data.moveSpeed*.7):e.right&&this.body.body.setVelocityX(this.data.moveSpeed*.7))}updateState(e){switch(this.state){case l.PUNCH:this.stateTimer>=d.PUNCH_DURATION&&(this.canAct=!0,this.hasHit=!1,this.enterState(l.IDLE));break;case l.KICK:this.stateTimer>=d.KICK_DURATION&&(this.canAct=!0,this.hasHit=!1,this.enterState(l.IDLE));break;case l.SPECIAL:this.updateSpecial(e),this.stateTimer>=this.specialDuration&&(this.canAct=!0,this.hasHit=!1,this.specialHitCount=0,this.armorActive=!1,this._effectPhase=0,this._effectTimer=0,this.body.body.setVelocityX(0),this.enterState(l.IDLE));break;case l.HIT:this.stateTimer>=d.HITSTUN_DURATION&&(this.canAct=!0,this.enterState(l.IDLE));break;case l.JUMP:this.isGrounded&&this.stateTimer>100&&(this.body.body.setVelocityX(0),this.enterState(l.IDLE));break;case l.KO:if(this.stateTimer<500){const t=this.facingRight?-1:1;this.body.body.setVelocityX(t*100)}else this.body.body.setVelocityX(0);break}}updateSpecial(e){const t=this.stateTimer,i=this.specialDuration,s=this.facingRight?1:-1,a=d.BODY_HEIGHT,n=this.y+a/2;switch(this._effectTimer+=e,this.data.specialType){case"lunge":t>i*.2&&t<i*.7&&(this.body.body.setVelocityX(s*550),this._effectTimer>50&&(this._effectTimer=0,j(this.scene,this.x,this.y,s,this.data.color,4))),this._effectPhase<1&&t>i*.15&&(this._effectPhase=1,A(this.scene,this.x-s*20,n),p.whoosh());break;case"groundPound":t>i*.05&&t<i*.3&&this.body.body.setVelocityY(-600),t>i*.4&&t<i*.65&&(this.body.body.setVelocityY(1e3),this.body.body.setVelocityX(0)),this._effectPhase<1&&t>i*.05&&(this._effectPhase=1,A(this.scene,this.x,n,8947848)),this._effectPhase<2&&t>i*.55&&this.isGrounded&&(this._effectPhase=2,M(this.scene,this.x,n,this.data.color,100),B(this.scene,this.x,n),A(this.scene,this.x-30,n,6710886),A(this.scene,this.x+30,n,6710886),this.scene.cameras.main.shake(250,.02),p.heavyImpact());break;case"teleport":if(this._effectPhase<1&&t>i*.15&&(this._effectPhase=1,he(this.scene,this.x,this.y,this.data.color),p.warp()),t>i*.3&&t<i*.35&&this.opponent){const h=this.opponent.x+(this.opponent.facingRight?-70:70);this.body.setPosition(f.Math.Clamp(h,d.STAGE_LEFT+30,d.STAGE_RIGHT-30),this.body.y)}this._effectPhase<2&&t>i*.35&&(this._effectPhase=2,re(this.scene,this.x,this.y,this.data.color));break;case"uppercut":t>i*.2&&t<i*.5&&(this.body.body.setVelocityY(-700),this.body.body.setVelocityX(s*180),this._effectTimer>40&&(this._effectTimer=0,Z(this.scene,this.x,this.y+20,s,this.data.color))),this._effectPhase<1&&t>i*.15&&(this._effectPhase=1,$(this.scene,this.x+s*20,this.y,this.data.color,10),p.risingAttack());break;case"slide":t>i*.15&&t<i*.7&&(this.body.body.setVelocityX(s*600),this._effectTimer>60&&(this._effectTimer=0,Q(this.scene,this.x,n,s,this.data.color))),this._effectPhase<1&&t>i*.1&&(this._effectPhase=1,ee(this.scene,this.x,n,this.data.color),p.iceSlide());break;case"lightningDrop":t<i*.25&&(this.body.body.setVelocityY(-700),this.body.body.setVelocityX(s*120),this._effectTimer>60&&(this._effectTimer=0,v(this.scene,this.x,this.y,this.data.color,4))),t>i*.35&&t<i*.65&&(this.body.body.setVelocityY(1e3),this.body.body.setVelocityX(0)),this._effectPhase<1&&t>i*.5&&this.isGrounded&&(this._effectPhase=1,te(this.scene,this.x,0,this.x,n,this.data.color),v(this.scene,this.x,n,this.data.color,12),M(this.scene,this.x,n,this.data.color,60),this.scene.cameras.main.shake(150,.012),p.electric());break;case"flurry":if(t>i*.12&&t<i*.8){this.body.body.setVelocityX(s*280);const h=i*.68/(this.data.specialHits||4),r=t-i*.12,c=Math.floor(r/h);c>this.specialHitCount&&(this.specialHitCount=c,this.hasHit=!1,ie(this.scene,this.x,this.y,s,this.data.color),p.flurryHit())}break;case"armorSmash":t<i*.5?(this.armorActive=!0,this._effectTimer>100&&(this._effectTimer=0,se(this.scene,this.x,this.y,this.data.color,45))):this.armorActive=!1,t>i*.45&&t<i*.65&&this.body.body.setVelocityX(s*400),this._effectPhase<1&&t>i*.5&&(this._effectPhase=1,B(this.scene,this.x+s*40,n,this.data.color),A(this.scene,this.x+s*40,n,8947848),this.scene.cameras.main.shake(150,.01),p.heavyImpact());break;case"whirlwind":if(t>i*.1&&t<i*.75&&(this.body.body.setVelocityX(s*180),this._effectTimer>50)){this._effectTimer=0;const h=t/i*Math.PI*8;ae(this.scene,this.x,this.y,h,this.data.color)}this._effectPhase<1&&t>i*.1&&(this._effectPhase=1,p.whoosh());break;case"explosion":if(t<i*.55){this.body.body.setVelocityX(0);const h=t/(i*.55);this._effectTimer>60&&(this._effectTimer=0,ne(this.scene,this.x,this.y,this.data.color,10+h*35))}this._effectPhase<1&&t>i*.55&&(this._effectPhase=1,oe(this.scene,this.x,this.y,this.data.color,130),this.scene.cameras.main.shake(300,.025),p.boom()),t>i*.6&&t<i*.7&&this.body.body.setVelocityX(-s*150);break}}enterState(e){switch(this.state=e,this.stateTimer=0,this.animFrame=0,this.animTimer=0,e){case l.PUNCH:p.punch();break;case l.KICK:p.kick();break;case l.SPECIAL:p.special();break;case l.JUMP:p.jump();break}[l.PUNCH,l.KICK,l.SPECIAL].includes(e)&&(this.canAct=!1,this.hasHit=!1),e===l.SPECIAL&&(this._effectPhase=0,this._effectTimer=0),e===l.HIT&&(this.canAct=!1)}isAttacking(){return[l.PUNCH,l.KICK,l.SPECIAL].includes(this.state)}isOnActiveFrame(){if(!this.isAttacking())return!1;let e,t,i;switch(this.state){case l.PUNCH:e=d.PUNCH_DURATION,t=e*.3,i=e*.6;break;case l.KICK:e=d.KICK_DURATION,t=e*.25,i=e*.6;break;case l.SPECIAL:switch(e=this.specialDuration,this.data.specialType){case"lunge":t=e*.25,i=e*.65;break;case"groundPound":t=e*.5,i=e*.7;break;case"teleport":t=e*.4,i=e*.7;break;case"uppercut":t=e*.2,i=e*.5;break;case"slide":t=e*.2,i=e*.7;break;case"lightningDrop":t=e*.45,i=e*.65;break;case"flurry":t=e*.12,i=e*.8;break;case"armorSmash":t=e*.5,i=e*.7;break;case"whirlwind":t=e*.12,i=e*.75;break;case"explosion":t=e*.55,i=e*.75;break;default:t=e*.2,i=e*.6}break;default:return!1}return this.stateTimer>=t&&this.stateTimer<=i}getAttackData(){switch(this.state){case l.PUNCH:return{damage:this.data.punchDamage,range:this.data.punchRange,knockback:d.PUNCH_KNOCKBACK};case l.KICK:return{damage:this.data.kickDamage,range:this.data.kickRange,knockback:d.KICK_KNOCKBACK};case l.SPECIAL:return{damage:this.data.specialDamage,range:this.data.specialRange,knockback:d.SPECIAL_KNOCKBACK};default:return null}}getHitboxRect(){const e=this.getAttackData();if(!e)return null;const t=this.facingRight?1:-1,i=this.x,s=this.y;if(this.state===l.SPECIAL)switch(this.data.specialType){case"explosion":return new f.Geom.Rectangle(i-e.range/2,s-e.range/3,e.range,e.range*.66);case"groundPound":return new f.Geom.Rectangle(i-e.range/2,s-20,e.range,60);case"whirlwind":return new f.Geom.Rectangle(i-e.range/2,s-30,e.range,60)}const a=t>0?i+d.BODY_WIDTH/2:i-d.BODY_WIDTH/2-e.range;return new f.Geom.Rectangle(a,s-25,e.range,50)}getHurtboxRect(){return new f.Geom.Rectangle(this.x-d.BODY_WIDTH/2,this.y-d.BODY_HEIGHT/2,d.BODY_WIDTH,d.BODY_HEIGHT)}takeDamage(e,t){if(this.armorActive){this.health-=e*.3,this.health=Math.max(0,this.health);return}this.state===l.BLOCK?(this.health-=e*(1-d.BLOCK_DAMAGE_REDUCTION),this.body.body.setVelocityX(t*.3)):(this.health-=e,this.body.body.setVelocityX(t),this.body.body.setVelocityY(-150),this.enterState(l.HIT)),this.health=Math.max(0,this.health),this.health<=0&&(this.enterState(l.KO),this.canAct=!1)}setFacing(e){this.facingRight=e}resetForRound(e){this.body.setPosition(e,d.GROUND_Y-d.BODY_HEIGHT/2),this.body.body.setVelocity(0,0),this.health=this.maxHealth,this.state=l.IDLE,this.stateTimer=0,this.specialCooldown=0,this.canAct=!0,this.hasHit=!1,this.specialHitCount=0,this.armorActive=!1,this._effectPhase=0,this._effectTimer=0}draw(){const e=w[this.state];if(!e)return;let t;const i=e.length;if(i===1)t=e[0];else{let h,r=!1;switch(this.state){case l.PUNCH:h=d.PUNCH_DURATION;break;case l.KICK:h=d.KICK_DURATION;break;case l.SPECIAL:h=this.specialDuration;break;case l.KO:h=800;break;case l.JUMP:h=600;break;case l.HIT:h=d.HITSTUN_DURATION;break;case l.IDLE:h=800,r=!0;break;case l.WALK_FORWARD:h=400,r=!0;break;case l.WALK_BACKWARD:h=450,r=!0;break;case l.VICTORY:h=900,r=!0;break;default:h=400;break}const c=r?this.stateTimer%h:this.stateTimer,y=h/i,x=r?Math.floor(c/y)%i:Math.min(Math.floor(c/y),i-1),b=r?(x+1)%i:Math.min(x+1,i-1),D=c%y/y;x===b||this.state===l.KO?t=e[x]:t=z(e[x],e[b],D)}const s=this.x,a=this.y+d.BODY_HEIGHT/2-60,n=this.isAttacking();this.renderer.draw(s,a,t,this.facingRight,this.data.color,n)}destroy(){this.graphics.destroy(),this.body.destroy()}}const ce={0:{left:"A",right:"D",jump:"W",punch:"J",kick:"K",special:"L",block:"S"},1:{left:"LEFT",right:"RIGHT",jump:"UP",punch:"COMMA",kick:"PERIOD",special:"FORWARD_SLASH",block:"DOWN"}};class G{constructor(e,t){this.scene=e,this.playerIndex=t,this.gamepad=null;const i=ce[t];this.keys={};for(const s in i)this.keys[s]=e.input.keyboard.addKey(f.Input.Keyboard.KeyCodes[i[s]]);this.prevState={jump:!1,punch:!1,kick:!1,special:!1},e.input.gamepad&&(e.input.gamepad.on("connected",s=>{s.index===t&&!this.gamepad&&(this.gamepad=s)}),e.input.gamepad.pad1&&t===0&&(this.gamepad=e.input.gamepad.pad1),e.input.gamepad.pad2&&t===1&&(this.gamepad=e.input.gamepad.pad2))}getActions(){const e=this.readKeyboard(),t=this.readGamepad(),i={left:e.left||t.left,right:e.right||t.right,jump:e.jump||t.jump,punch:e.punch||t.punch,kick:e.kick||t.kick,special:e.special||t.special,block:e.block||t.block},s={left:i.left,right:i.right,jump:i.jump&&!this.prevState.jump,punch:i.punch&&!this.prevState.punch,kick:i.kick&&!this.prevState.kick,special:i.special&&!this.prevState.special,block:i.block};return this.prevState={jump:i.jump,punch:i.punch,kick:i.kick,special:i.special},s}readKeyboard(){return{left:this.keys.left.isDown,right:this.keys.right.isDown,jump:this.keys.jump.isDown,punch:this.keys.punch.isDown,kick:this.keys.kick.isDown,special:this.keys.special.isDown,block:this.keys.block.isDown}}readGamepad(){const e=this.gamepad,t={left:!1,right:!1,jump:!1,punch:!1,kick:!1,special:!1,block:!1};if(!e||!e.connected)return t;const i=.3,s=e.leftStick?e.leftStick.x:0;return{left:e.left||s<-i,right:e.right||s>i,jump:e.A,punch:e.B,kick:e.Y,special:e.X,block:e.L1||e.R1}}}class F{constructor(e,t,i,s,a,n){this.x=t,this.y=i,this.width=s,this.height=a,this.playerIndex=n,this.graphics=e.add.graphics(),this.graphics.setDepth(100)}update(e,t){const i=this.graphics;i.clear();const s=Math.max(0,e/t),a=this.width*s,n=this.playerIndex===0;i.fillStyle(3355443,1),i.fillRect(this.x,this.y,this.width,this.height);let h;s>.5?h=52292:s>.25?h=13421568:h=13369344,i.fillStyle(h,1),n?i.fillRect(this.x,this.y,a,this.height):i.fillRect(this.x+this.width-a,this.y,a,this.height),i.lineStyle(2,16777215,1),i.strokeRect(this.x,this.y,this.width,this.height)}destroy(){this.graphics.destroy()}}class W{constructor(e,t,i,s=!1){this.x=t,this.y=i,this.alignRight=s,this.graphics=e.add.graphics(),this.graphics.setDepth(100)}update(e){const t=this.graphics;t.clear();for(let i=0;i<d.ROUNDS_TO_WIN;i++){const s=this.alignRight?this.x-i*25:this.x+i*25;i<e&&(t.fillStyle(16763904,1),t.fillCircle(s,this.y,8)),t.lineStyle(2,6710886,1),t.strokeCircle(s,this.y,8)}}destroy(){this.graphics.destroy()}}class le extends f.Scene{constructor(){super("FightScene")}create(){this.p1Wins=this.registry.get("p1Wins"),this.p2Wins=this.registry.get("p2Wins"),this.currentRound=this.registry.get("currentRound"),this.roundActive=!1,this.createArena(),this.createFighters(),this.createUI(),this.startRound()}createArena(){const e=this.add.graphics();e.fillStyle(1450302,1),e.fillRect(0,0,1280,d.GROUND_Y),e.fillStyle(3355460,1),e.fillRect(0,d.GROUND_Y,1280,100),e.lineStyle(3,5592439,1),e.lineBetween(0,d.GROUND_Y,1280,d.GROUND_Y),e.lineStyle(1,3355477,.5),e.lineBetween(d.STAGE_LEFT,0,d.STAGE_LEFT,d.GROUND_Y),e.lineBetween(d.STAGE_RIGHT,0,d.STAGE_RIGHT,d.GROUND_Y),this.physics.world.setBounds(d.STAGE_LEFT,0,d.STAGE_RIGHT-d.STAGE_LEFT,d.GROUND_Y),this.ground=this.add.zone(640,d.GROUND_Y+10,1280,20),this.physics.add.existing(this.ground,!0)}createFighters(){const i=R[this.registry.get("p1Fighter")||0],s=R[this.registry.get("p2Fighter")||1];this.p1Data=i,this.p2Data=s,this.fighter1=new N(this,350,d.GROUND_Y,0,!0,i),this.fighter2=new N(this,930,d.GROUND_Y,1,!1,s),this.fighter1.opponent=this.fighter2,this.fighter2.opponent=this.fighter1,this.physics.add.collider(this.fighter1.body,this.ground),this.physics.add.collider(this.fighter2.body,this.ground),this.physics.add.collider(this.fighter1.body,this.fighter2.body),this.p1Input=new G(this,0),this.p2Input=new G(this,1)}createUI(){this.p1HealthBar=new F(this,50,25,480,28,0),this.p2HealthBar=new F(this,750,25,480,28,1),this.add.text(50,7,this.p1Data.name,{fontSize:"14px",fontFamily:"monospace",color:`#${this.p1Data.color.toString(16).padStart(6,"0")}`}),this.add.text(1230,7,this.p2Data.name,{fontSize:"14px",fontFamily:"monospace",color:`#${this.p2Data.color.toString(16).padStart(6,"0")}`}).setOrigin(1,0),this.p1RoundInd=new W(this,50,71,!1),this.p2RoundInd=new W(this,1230,71,!0),this.add.text(640,30,"VS",{fontSize:"20px",fontFamily:"monospace",color:"#666666",fontStyle:"bold"}).setOrigin(.5),this.roundText=this.add.text(640,68,`Round ${this.currentRound}`,{fontSize:"13px",fontFamily:"monospace",color:"#555555"}).setOrigin(.5);const s=80,a=6,n=91;this.spBarConfig={w:s,h:a},this.add.text(50,n-2,"SP",{fontSize:"9px",fontFamily:"monospace",color:"#666666"}),this.add.text(1230,n-2,"SP",{fontSize:"9px",fontFamily:"monospace",color:"#666666"}).setOrigin(1,0),this.p1SpBar=this.add.graphics(),this.p1SpBarX=68,this.p1SpBarY=n,this.p2SpBar=this.add.graphics(),this.p2SpBarX=1230-s,this.p2SpBarY=n,this.p1HealthBar.update(d.MAX_HEALTH,d.MAX_HEALTH),this.p2HealthBar.update(d.MAX_HEALTH,d.MAX_HEALTH),this.p1RoundInd.update(this.p1Wins),this.p2RoundInd.update(this.p2Wins)}startRound(){this.roundActive=!1;const e=this.add.text(640,300,`ROUND ${this.currentRound}`,{fontSize:"64px",fontFamily:"monospace",color:"#ffffff",fontStyle:"bold"}).setOrigin(.5).setDepth(200);this.time.delayedCall(1e3,()=>{e.setText("FIGHT!"),e.setColor("#ffcc00"),e.setFontSize("80px"),p.roundStart(),this.time.delayedCall(600,()=>{this.tweens.add({targets:e,alpha:0,duration:300,onComplete:()=>e.destroy()}),this.roundActive=!0})})}update(e,t){if(this.p1HealthBar.update(this.fighter1.health,this.fighter1.maxHealth),this.p2HealthBar.update(this.fighter2.health,this.fighter2.maxHealth),this.p1RoundInd.update(this.p1Wins),this.p2RoundInd.update(this.p2Wins),this.drawSpBar(this.p1SpBar,this.p1SpBarX,this.p1SpBarY,this.fighter1.specialCooldown,this.p1Data.color),this.drawSpBar(this.p2SpBar,this.p2SpBarX,this.p2SpBarY,this.fighter2.specialCooldown,this.p2Data.color),!this.roundActive)return;const i=this.p1Input.getActions(),s=this.p2Input.getActions();this.fighter1.update(t,i),this.fighter2.update(t,s),this.updateFacing(),this.checkHits(this.fighter1,this.fighter2),this.checkHits(this.fighter2,this.fighter1),this.fighter1.health<=0&&this.fighter1.state==="KO"?this.endRound(1):this.fighter2.health<=0&&this.fighter2.state==="KO"&&this.endRound(0)}updateFacing(){this.fighter1.x<this.fighter2.x?(this.fighter1.setFacing(!0),this.fighter2.setFacing(!1)):(this.fighter1.setFacing(!1),this.fighter2.setFacing(!0))}checkHits(e,t){if(!e.isAttacking()||!e.isOnActiveFrame()||e.hasHit)return;const i=e.getHitboxRect(),s=t.getHurtboxRect();if(!(!i||!s)&&f.Geom.Rectangle.Overlaps(i,s)){e.hasHit=!0;const a=e.getAttackData(),n=e.facingRight?1:-1,h=t.state==="BLOCK";t.takeDamage(a.damage,n*a.knockback),h?p.block():p.hit(),this.cameras.main.shake(100,.005*a.damage),this.createHitSpark(i.x+i.width/2,i.y+i.height/2,h)}}createHitSpark(e,t,i){const s=this.add.graphics();s.setDepth(50);const a=i?4491519:16755200,n=i?15:25;for(let h=0;h<8;h++){const r=Math.PI*2*h/8,c=n+Math.random()*10;s.lineStyle(3,a,1),s.lineBetween(e,t,e+Math.cos(r)*c,t+Math.sin(r)*c)}this.tweens.add({targets:s,alpha:0,duration:200,onComplete:()=>s.destroy()})}drawSpBar(e,t,i,s,a){const{w:n,h}=this.spBarConfig,r=s<=0?1:1-s/d.SPECIAL_COOLDOWN;e.clear(),e.fillStyle(1118498,.8),e.fillRect(t,i,n,h);const c=r>=1?16763904:a;e.fillStyle(c,r>=1?.9:.6),e.fillRect(t,i,n*r,h),e.lineStyle(1,r>=1?16763904:4473958,.8),e.strokeRect(t,i,n,h)}endRound(e){this.roundActive=!1,e===0?this.p1Wins++:this.p2Wins++;const t=e===0?this.fighter1:this.fighter2,i=e===0?this.fighter2:this.fighter1;t.enterState("VICTORY"),i.enterState("KO");const s=this.add.text(640,300,"K.O.!",{fontSize:"80px",fontFamily:"monospace",color:"#ff3333",fontStyle:"bold"}).setOrigin(.5).setDepth(200);p.ko(),this.cameras.main.shake(300,.01),this.time.delayedCall(d.ROUND_END_DELAY,()=>{s.destroy(),this.p1Wins>=d.ROUNDS_TO_WIN||this.p2Wins>=d.ROUNDS_TO_WIN?(this.registry.set("p1Wins",this.p1Wins),this.registry.set("p2Wins",this.p2Wins),this.registry.set("matchWinner",e),this.cleanUp(),this.scene.start("ResultScene")):(this.registry.set("p1Wins",this.p1Wins),this.registry.set("p2Wins",this.p2Wins),this.registry.set("currentRound",this.currentRound+1),this.cleanUp(),this.scene.restart())})}cleanUp(){this.fighter1.destroy(),this.fighter2.destroy(),this.p1HealthBar.destroy(),this.p2HealthBar.destroy(),this.p1RoundInd.destroy(),this.p2RoundInd.destroy()}}class de extends f.Scene{constructor(){super("ResultScene")}create(){const e=this.registry.get("matchWinner"),t=this.registry.get("p1Wins"),i=this.registry.get("p2Wins"),s=this.registry.get("p1Fighter")||0,a=this.registry.get("p2Fighter")||1,n=e===0?R[s]:R[a],h=e===0?R[a]:R[s];p.victory();const r=e===0?"PLAYER 1":"PLAYER 2";this.add.text(640,120,`${r} WINS!`,{fontSize:"64px",fontFamily:"monospace",color:"#ffcc00",fontStyle:"bold"}).setOrigin(.5),this.add.text(640,190,n.name,{fontSize:"28px",fontFamily:"monospace",color:e===0?"#ffffff":"#00ffff"}).setOrigin(.5),this.add.text(640,250,`${t} - ${i}`,{fontSize:"48px",fontFamily:"monospace",color:"#ffffff"}).setOrigin(.5);const c=this.add.graphics();new T(c).draw(640,460,w.VICTORY[0],!0,n.color);const x=this.add.graphics(),b=new T(x),D=w.KO[w.KO.length-1],K=e===0?900:380;b.draw(K,480,D,e!==0,h.color);const O=this.add.text(640,620,"Press ENTER or SPACE to play again",{fontSize:"22px",fontFamily:"monospace",color:"#ffcc00"}).setOrigin(.5);this.tweens.add({targets:O,alpha:.3,duration:600,yoyo:!0,repeat:-1}),this.input.keyboard.on("keydown-ENTER",this.restart,this),this.input.keyboard.on("keydown-SPACE",this.restart,this),this.input.gamepad.on("down",()=>this.restart())}restart(){p.menuSelect(),this.scene.start("CharacterSelectScene")}}const ye={type:f.AUTO,width:1280,height:720,parent:"game-container",backgroundColor:"#1a1a2e",physics:{default:"arcade",arcade:{gravity:{y:1200},debug:!1}},scale:{mode:f.Scale.FIT,autoCenter:f.Scale.CENTER_BOTH},input:{gamepad:!0},scene:[X,J,q,le,de]};new f.Game(ye);
