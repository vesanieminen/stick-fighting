import{r as V,g as U}from"./phaser-Czz4FBZH.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();var Y=V();const f=U(Y);class X extends f.Scene{constructor(){super("BootScene")}create(){this.registry.set("p1Wins",0),this.registry.set("p2Wins",0),this.registry.set("currentRound",1),this.scene.start("TitleScene")}}const d={GROUND_Y:620,STAGE_LEFT:50,STAGE_RIGHT:1230,MAX_HEALTH:100,PUNCH_DURATION:250,PUNCH_KNOCKBACK:200,KICK_DURATION:400,KICK_KNOCKBACK:350,SPECIAL_DURATION:500,SPECIAL_KNOCKBACK:500,SPECIAL_COOLDOWN:3e3,BLOCK_DAMAGE_REDUCTION:.8,BLOCK_ATTACKER_PUSHBACK:250,BLOCK_ATTACKER_STUN:300,PUNCH_RECOVERY:180,KICK_RECOVERY:120,SPECIAL_RECOVERY:250,STALE_MOVE_PENALTY:.2,STALE_MOVE_MIN:.4,STALE_MOVE_RESET_TIME:1500,ROUNDS_TO_WIN:2,ROUND_END_DELAY:2e3,HITSTUN_DURATION:250,HEAD_RADIUS:14,LINE_WIDTH:4,BODY_WIDTH:40,BODY_HEIGHT:120};class T{constructor(t){this.graphics=t}draw(t,e,i,s,a=16777215,o=!1){const h=this.graphics,r=s?1:-1;if(h.clear(),o){const y=this.transformPose(t-r*10,e,i,r);this.drawFigure(h,y,a,.12)}const c=this.transformPose(t,e,i,r);this.drawFigure(h,c,a,1)}transformPose(t,e,i,s){const a={};for(const o in i)a[o]={x:t+i[o].x*s,y:e+i[o].y};return a}drawFigure(t,e,i,s){const a=d.LINE_WIDTH,o=d.HEAD_RADIUS;t.fillStyle(i,.25*s),t.fillCircle(e.head.x,e.head.y,o),t.lineStyle(a,i,s),t.strokeCircle(e.head.x,e.head.y,o),t.lineStyle(a+1,i,s),t.lineBetween(e.neck.x,e.neck.y,e.hip.x,e.hip.y),t.lineStyle(a,i,s),t.lineBetween(e.shoulderL.x,e.shoulderL.y,e.shoulderR.x,e.shoulderR.y),this.drawLimb(t,e.shoulderL,e.elbowL,i,a,s),this.drawLimb(t,e.elbowL,e.handL,i,a,s),this.drawLimb(t,e.shoulderR,e.elbowR,i,a,s),this.drawLimb(t,e.elbowR,e.handR,i,a,s),this.drawLimb(t,e.hip,e.kneeL,i,a,s),this.drawLimb(t,e.kneeL,e.footL,i,a,s),this.drawLimb(t,e.hip,e.kneeR,i,a,s),this.drawLimb(t,e.kneeR,e.footR,i,a,s),t.fillStyle(i,.7*s);const h=2.5;t.fillCircle(e.elbowL.x,e.elbowL.y,h),t.fillCircle(e.elbowR.x,e.elbowR.y,h),t.fillCircle(e.kneeL.x,e.kneeL.y,h),t.fillCircle(e.kneeR.x,e.kneeR.y,h);const r=3;t.fillCircle(e.handL.x,e.handL.y,r),t.fillCircle(e.handR.x,e.handR.y,r),t.fillCircle(e.footL.x,e.footL.y,r),t.fillCircle(e.footR.x,e.footR.y,r)}drawLimb(t,e,i,s,a,o){t.lineStyle(a,s,o),t.lineBetween(e.x,e.y,i.x,i.y)}}const w={IDLE:[{head:{x:3,y:-100},neck:{x:2,y:-82},hip:{x:0,y:-2},shoulderL:{x:-15,y:-80},shoulderR:{x:15,y:-80},elbowL:{x:-3,y:-62},elbowR:{x:26,y:-66},handL:{x:12,y:-80},handR:{x:32,y:-84},kneeL:{x:-18,y:24},kneeR:{x:18,y:24},footL:{x:-24,y:60},footR:{x:22,y:60}},{head:{x:3,y:-97},neck:{x:2,y:-79},hip:{x:0,y:2},shoulderL:{x:-15,y:-77},shoulderR:{x:15,y:-77},elbowL:{x:-5,y:-59},elbowR:{x:24,y:-63},handL:{x:10,y:-77},handR:{x:30,y:-81},kneeL:{x:-18,y:27},kneeR:{x:18,y:27},footL:{x:-24,y:60},footR:{x:22,y:60}},{head:{x:3,y:-94},neck:{x:2,y:-76},hip:{x:0,y:6},shoulderL:{x:-15,y:-74},shoulderR:{x:15,y:-74},elbowL:{x:-7,y:-56},elbowR:{x:22,y:-60},handL:{x:8,y:-74},handR:{x:28,y:-78},kneeL:{x:-18,y:30},kneeR:{x:18,y:30},footL:{x:-24,y:60},footR:{x:22,y:60}},{head:{x:3,y:-97},neck:{x:2,y:-79},hip:{x:0,y:2},shoulderL:{x:-15,y:-77},shoulderR:{x:15,y:-77},elbowL:{x:-5,y:-59},elbowR:{x:24,y:-63},handL:{x:10,y:-77},handR:{x:30,y:-81},kneeL:{x:-18,y:27},kneeR:{x:18,y:27},footL:{x:-24,y:60},footR:{x:22,y:60}}],WALK_FORWARD:[{head:{x:8,y:-98},neck:{x:6,y:-80},hip:{x:0,y:0},shoulderL:{x:-12,y:-78},shoulderR:{x:16,y:-78},elbowL:{x:8,y:-64},elbowR:{x:10,y:-58},handL:{x:20,y:-74},handR:{x:6,y:-44},kneeL:{x:-8,y:26},kneeR:{x:26,y:20},footL:{x:-14,y:60},footR:{x:36,y:60}},{head:{x:5,y:-100},neck:{x:4,y:-82},hip:{x:0,y:-2},shoulderL:{x:-14,y:-80},shoulderR:{x:14,y:-80},elbowL:{x:-2,y:-64},elbowR:{x:24,y:-66},handL:{x:12,y:-78},handR:{x:30,y:-80},kneeL:{x:-6,y:26},kneeR:{x:10,y:26},footL:{x:-8,y:60},footR:{x:14,y:60}},{head:{x:8,y:-98},neck:{x:6,y:-80},hip:{x:0,y:0},shoulderL:{x:-12,y:-78},shoulderR:{x:16,y:-78},elbowL:{x:-14,y:-56},elbowR:{x:30,y:-66},handL:{x:-8,y:-42},handR:{x:36,y:-78},kneeL:{x:-26,y:20},kneeR:{x:8,y:26},footL:{x:-36,y:60},footR:{x:14,y:60}},{head:{x:5,y:-100},neck:{x:4,y:-82},hip:{x:0,y:-2},shoulderL:{x:-14,y:-80},shoulderR:{x:14,y:-80},elbowL:{x:-2,y:-64},elbowR:{x:24,y:-66},handL:{x:12,y:-78},handR:{x:30,y:-80},kneeL:{x:-6,y:26},kneeR:{x:10,y:26},footL:{x:-8,y:60},footR:{x:14,y:60}}],WALK_BACKWARD:[{head:{x:-4,y:-96},neck:{x:-3,y:-78},hip:{x:0,y:3},shoulderL:{x:-16,y:-76},shoulderR:{x:12,y:-76},elbowL:{x:-6,y:-62},elbowR:{x:20,y:-66},handL:{x:6,y:-76},handR:{x:26,y:-80},kneeL:{x:-26,y:22},kneeR:{x:6,y:26},footL:{x:-36,y:60},footR:{x:10,y:60}},{head:{x:-2,y:-98},neck:{x:-1,y:-80},hip:{x:0,y:1},shoulderL:{x:-14,y:-78},shoulderR:{x:14,y:-78},elbowL:{x:-4,y:-64},elbowR:{x:24,y:-66},handL:{x:10,y:-78},handR:{x:30,y:-82},kneeL:{x:-10,y:26},kneeR:{x:10,y:26},footL:{x:-14,y:60},footR:{x:14,y:60}},{head:{x:-4,y:-96},neck:{x:-3,y:-78},hip:{x:0,y:3},shoulderL:{x:-16,y:-76},shoulderR:{x:12,y:-76},elbowL:{x:-8,y:-60},elbowR:{x:22,y:-64},handL:{x:8,y:-74},handR:{x:28,y:-78},kneeL:{x:-6,y:26},kneeR:{x:26,y:22},footL:{x:-10,y:60},footR:{x:36,y:60}},{head:{x:-2,y:-98},neck:{x:-1,y:-80},hip:{x:0,y:1},shoulderL:{x:-14,y:-78},shoulderR:{x:14,y:-78},elbowL:{x:-4,y:-64},elbowR:{x:24,y:-66},handL:{x:10,y:-78},handR:{x:30,y:-82},kneeL:{x:-10,y:26},kneeR:{x:10,y:26},footL:{x:-14,y:60},footR:{x:14,y:60}}],JUMP:[{head:{x:0,y:-96},neck:{x:0,y:-78},hip:{x:0,y:0},shoulderL:{x:-14,y:-76},shoulderR:{x:14,y:-76},elbowL:{x:-22,y:-90},elbowR:{x:22,y:-90},handL:{x:-18,y:-105},handR:{x:18,y:-105},kneeL:{x:-20,y:12},kneeR:{x:20,y:12},footL:{x:-26,y:36},footR:{x:26,y:36}},{head:{x:0,y:-102},neck:{x:0,y:-84},hip:{x:0,y:0},shoulderL:{x:-16,y:-82},shoulderR:{x:16,y:-82},elbowL:{x:-34,y:-74},elbowR:{x:34,y:-74},handL:{x:-44,y:-62},handR:{x:44,y:-62},kneeL:{x:-24,y:16},kneeR:{x:24,y:16},footL:{x:-34,y:42},footR:{x:34,y:42}},{head:{x:3,y:-94},neck:{x:2,y:-76},hip:{x:0,y:4},shoulderL:{x:-14,y:-74},shoulderR:{x:14,y:-74},elbowL:{x:-6,y:-62},elbowR:{x:24,y:-64},handL:{x:8,y:-74},handR:{x:30,y:-76},kneeL:{x:-16,y:22},kneeR:{x:16,y:22},footL:{x:-22,y:50},footR:{x:22,y:50}}],PUNCH:[{head:{x:-8,y:-98},neck:{x:-6,y:-80},hip:{x:0,y:3},shoulderL:{x:-20,y:-78},shoulderR:{x:8,y:-78},elbowL:{x:-10,y:-62},elbowR:{x:-6,y:-60},handL:{x:6,y:-76},handR:{x:-12,y:-52},kneeL:{x:-16,y:26},kneeR:{x:20,y:24},footL:{x:-22,y:60},footR:{x:26,y:60}},{head:{x:10,y:-98},neck:{x:8,y:-80},hip:{x:0,y:0},shoulderL:{x:-8,y:-78},shoulderR:{x:22,y:-78},elbowL:{x:-4,y:-62},elbowR:{x:48,y:-76},handL:{x:8,y:-74},handR:{x:72,y:-76},kneeL:{x:-16,y:26},kneeR:{x:18,y:24},footL:{x:-22,y:60},footR:{x:24,y:60}},{head:{x:14,y:-96},neck:{x:10,y:-78},hip:{x:0,y:0},shoulderL:{x:-6,y:-76},shoulderR:{x:24,y:-76},elbowL:{x:-2,y:-60},elbowR:{x:54,y:-74},handL:{x:6,y:-72},handR:{x:82,y:-74},kneeL:{x:-14,y:26},kneeR:{x:20,y:24},footL:{x:-20,y:60},footR:{x:28,y:60}},{head:{x:6,y:-98},neck:{x:4,y:-80},hip:{x:0,y:1},shoulderL:{x:-12,y:-78},shoulderR:{x:16,y:-78},elbowL:{x:-4,y:-62},elbowR:{x:36,y:-66},handL:{x:10,y:-76},handR:{x:44,y:-72},kneeL:{x:-16,y:26},kneeR:{x:18,y:26},footL:{x:-22,y:60},footR:{x:22,y:60}}],KICK:[{head:{x:-6,y:-98},neck:{x:-4,y:-80},hip:{x:0,y:3},shoulderL:{x:-18,y:-78},shoulderR:{x:12,y:-78},elbowL:{x:-34,y:-66},elbowR:{x:28,y:-62},handL:{x:-42,y:-52},handR:{x:34,y:-48},kneeL:{x:-16,y:28},kneeR:{x:28,y:-8},footL:{x:-22,y:60},footR:{x:22,y:8}},{head:{x:-10,y:-96},neck:{x:-8,y:-78},hip:{x:0,y:3},shoulderL:{x:-22,y:-76},shoulderR:{x:8,y:-76},elbowL:{x:-38,y:-62},elbowR:{x:22,y:-58},handL:{x:-46,y:-48},handR:{x:28,y:-44},kneeL:{x:-16,y:28},kneeR:{x:44,y:-10},footL:{x:-22,y:60},footR:{x:68,y:-12}},{head:{x:-18,y:-92},neck:{x:-14,y:-74},hip:{x:0,y:6},shoulderL:{x:-26,y:-72},shoulderR:{x:4,y:-72},elbowL:{x:-42,y:-58},elbowR:{x:16,y:-54},handL:{x:-50,y:-44},handR:{x:22,y:-40},kneeL:{x:-18,y:30},kneeR:{x:48,y:-8},footL:{x:-26,y:60},footR:{x:88,y:-8}},{head:{x:-6,y:-96},neck:{x:-4,y:-78},hip:{x:0,y:3},shoulderL:{x:-18,y:-76},shoulderR:{x:12,y:-76},elbowL:{x:-30,y:-62},elbowR:{x:26,y:-60},handL:{x:-36,y:-50},handR:{x:32,y:-50},kneeL:{x:-16,y:28},kneeR:{x:24,y:18},footL:{x:-22,y:60},footR:{x:34,y:46}}],SPECIAL:[{head:{x:-4,y:-84},neck:{x:-3,y:-66},hip:{x:0,y:14},shoulderL:{x:-18,y:-64},shoulderR:{x:18,y:-64},elbowL:{x:-28,y:-46},elbowR:{x:10,y:-48},handL:{x:-22,y:-32},handR:{x:2,y:-38},kneeL:{x:-22,y:34},kneeR:{x:22,y:34},footL:{x:-28,y:60},footR:{x:26,y:60}},{head:{x:8,y:-98},neck:{x:6,y:-80},hip:{x:0,y:2},shoulderL:{x:-12,y:-78},shoulderR:{x:20,y:-78},elbowL:{x:-6,y:-64},elbowR:{x:42,y:-70},handL:{x:8,y:-76},handR:{x:56,y:-66},kneeL:{x:-18,y:26},kneeR:{x:20,y:22},footL:{x:-24,y:60},footR:{x:28,y:60}},{head:{x:16,y:-100},neck:{x:12,y:-82},hip:{x:0,y:-2},shoulderL:{x:-6,y:-80},shoulderR:{x:24,y:-80},elbowL:{x:0,y:-66},elbowR:{x:54,y:-76},handL:{x:12,y:-78},handR:{x:80,y:-72},kneeL:{x:-22,y:22},kneeR:{x:24,y:18},footL:{x:-30,y:60},footR:{x:34,y:60}},{head:{x:6,y:-98},neck:{x:4,y:-80},hip:{x:0,y:2},shoulderL:{x:-12,y:-78},shoulderR:{x:16,y:-78},elbowL:{x:-6,y:-62},elbowR:{x:34,y:-64},handL:{x:8,y:-74},handR:{x:42,y:-60},kneeL:{x:-18,y:26},kneeR:{x:18,y:26},footL:{x:-24,y:60},footR:{x:22,y:60}}],BLOCK:[{head:{x:-8,y:-92},neck:{x:-6,y:-74},hip:{x:0,y:8},shoulderL:{x:-14,y:-72},shoulderR:{x:12,y:-72},elbowL:{x:-2,y:-62},elbowR:{x:8,y:-62},handL:{x:10,y:-82},handR:{x:14,y:-54},kneeL:{x:-20,y:30},kneeR:{x:20,y:30},footL:{x:-26,y:60},footR:{x:24,y:60}}],HIT:[{head:{x:-18,y:-94},neck:{x:-14,y:-76},hip:{x:0,y:6},shoulderL:{x:-24,y:-74},shoulderR:{x:2,y:-74},elbowL:{x:-40,y:-58},elbowR:{x:-12,y:-54},handL:{x:-48,y:-42},handR:{x:-20,y:-38},kneeL:{x:-6,y:28},kneeR:{x:18,y:26},footL:{x:-10,y:60},footR:{x:24,y:60}},{head:{x:-12,y:-96},neck:{x:-10,y:-78},hip:{x:0,y:4},shoulderL:{x:-20,y:-76},shoulderR:{x:8,y:-76},elbowL:{x:-34,y:-60},elbowR:{x:-2,y:-56},handL:{x:-38,y:-46},handR:{x:-8,y:-42},kneeL:{x:-12,y:28},kneeR:{x:16,y:28},footL:{x:-16,y:60},footR:{x:22,y:60}}],KO:[{head:{x:-22,y:-88},neck:{x:-16,y:-70},hip:{x:0,y:8},shoulderL:{x:-26,y:-68},shoulderR:{x:0,y:-68},elbowL:{x:-40,y:-52},elbowR:{x:-12,y:-48},handL:{x:-48,y:-36},handR:{x:-20,y:-32},kneeL:{x:-4,y:30},kneeR:{x:20,y:28},footL:{x:-8,y:60},footR:{x:28,y:60}},{head:{x:-34,y:-55},neck:{x:-26,y:-40},hip:{x:0,y:24},shoulderL:{x:-30,y:-36},shoulderR:{x:-18,y:-34},elbowL:{x:-42,y:-20},elbowR:{x:-14,y:-18},handL:{x:-50,y:-4},handR:{x:-10,y:0},kneeL:{x:10,y:40},kneeR:{x:26,y:38},footL:{x:18,y:58},footR:{x:38,y:56}},{head:{x:-44,y:34},neck:{x:-32,y:38},hip:{x:0,y:46},shoulderL:{x:-36,y:36},shoulderR:{x:-28,y:40},elbowL:{x:-48,y:44},elbowR:{x:-18,y:46},handL:{x:-58,y:50},handR:{x:-12,y:52},kneeL:{x:20,y:42},kneeR:{x:30,y:46},footL:{x:38,y:48},footR:{x:50,y:52}}],VICTORY:[{head:{x:0,y:-104},neck:{x:0,y:-86},hip:{x:0,y:-4},shoulderL:{x:-16,y:-84},shoulderR:{x:16,y:-84},elbowL:{x:-24,y:-100},elbowR:{x:24,y:-100},handL:{x:-20,y:-116},handR:{x:20,y:-116},kneeL:{x:-14,y:24},kneeR:{x:14,y:24},footL:{x:-20,y:60},footR:{x:20,y:60}},{head:{x:0,y:-106},neck:{x:0,y:-88},hip:{x:0,y:-6},shoulderL:{x:-18,y:-86},shoulderR:{x:18,y:-86},elbowL:{x:-30,y:-106},elbowR:{x:30,y:-106},handL:{x:-34,y:-122},handR:{x:34,y:-122},kneeL:{x:-16,y:22},kneeR:{x:16,y:22},footL:{x:-22,y:60},footR:{x:22,y:60}},{head:{x:0,y:-104},neck:{x:0,y:-86},hip:{x:0,y:-2},shoulderL:{x:-18,y:-84},shoulderR:{x:18,y:-84},elbowL:{x:-36,y:-98},elbowR:{x:36,y:-98},handL:{x:-44,y:-112},handR:{x:44,y:-112},kneeL:{x:-18,y:24},kneeR:{x:18,y:24},footL:{x:-26,y:60},footR:{x:26,y:60}}]};function z(n,t,e){const i={};for(const s in n)i[s]={x:n[s].x+(t[s].x-n[s].x)*e,y:n[s].y+(t[s].y-n[s].y)*e};return i}let A=null;function b(){return A||(A=new(window.AudioContext||window.webkitAudioContext)),A.state==="suspended"&&A.resume(),A}function u(n,t,e="square",i=.15,s=!0){const a=b(),o=a.createOscillator(),h=a.createGain();o.type=e,o.frequency.value=n,h.gain.value=i,s&&h.gain.exponentialRampToValueAtTime(.001,a.currentTime+t),o.connect(h),h.connect(a.destination),o.start(a.currentTime),o.stop(a.currentTime+t)}function R(n,t=.1){const e=b(),i=e.sampleRate*n,s=e.createBuffer(1,i,e.sampleRate),a=s.getChannelData(0);for(let c=0;c<i;c++)a[c]=Math.random()*2-1;const o=e.createBufferSource();o.buffer=s;const h=e.createGain();h.gain.value=t,h.gain.exponentialRampToValueAtTime(.001,e.currentTime+n);const r=e.createBiquadFilter();r.type="bandpass",r.frequency.value=1e3,r.Q.value=.5,o.connect(r),r.connect(h),h.connect(e.destination),o.start(e.currentTime)}const p={punch(){u(200,.08,"square",.12),R(.06,.1)},kick(){u(140,.12,"square",.15),R(.1,.12),u(80,.1,"sine",.2)},special(){const n=b(),t=n.createOscillator(),e=n.createGain();t.type="sawtooth",t.frequency.value=150,t.frequency.exponentialRampToValueAtTime(600,n.currentTime+.2),e.gain.value=.12,e.gain.exponentialRampToValueAtTime(.001,n.currentTime+.3),t.connect(e),e.connect(n.destination),t.start(n.currentTime),t.stop(n.currentTime+.3),R(.15,.1)},block(){u(400,.06,"triangle",.08),u(300,.08,"triangle",.06)},hit(){u(160,.1,"square",.15),R(.08,.15),u(60,.15,"sine",.2)},ko(){const n=b(),t=n.createOscillator(),e=n.createGain();t.type="sawtooth",t.frequency.value=400,t.frequency.exponentialRampToValueAtTime(50,n.currentTime+.8),e.gain.value=.15,e.gain.exponentialRampToValueAtTime(.001,n.currentTime+.8),t.connect(e),e.connect(n.destination),t.start(n.currentTime),t.stop(n.currentTime+.8),R(.4,.12)},roundStart(){u(440,.1,"square",.08),setTimeout(()=>u(440,.1,"square",.08),200),setTimeout(()=>u(880,.2,"square",.1),400)},menuSelect(){u(660,.08,"square",.08),setTimeout(()=>u(880,.1,"square",.1),60)},victory(){[523,659,784,1047].forEach((t,e)=>{setTimeout(()=>u(t,.2,"square",.1),e*150)})},jump(){const n=b(),t=n.createOscillator(),e=n.createGain();t.type="sine",t.frequency.value=250,t.frequency.exponentialRampToValueAtTime(500,n.currentTime+.1),e.gain.value=.06,e.gain.exponentialRampToValueAtTime(.001,n.currentTime+.12),t.connect(e),e.connect(n.destination),t.start(n.currentTime),t.stop(n.currentTime+.12)},land(){u(80,.06,"sine",.08)},whoosh(){R(.1,.04)},boom(){const n=b(),t=n.createOscillator(),e=n.createGain();t.type="sine",t.frequency.value=60,t.frequency.exponentialRampToValueAtTime(20,n.currentTime+.4),e.gain.value=.25,e.gain.exponentialRampToValueAtTime(.001,n.currentTime+.4),t.connect(e),e.connect(n.destination),t.start(n.currentTime),t.stop(n.currentTime+.4),R(.3,.18)},warp(){const n=b(),t=n.createOscillator(),e=n.createGain();t.type="sine",t.frequency.value=800,t.frequency.exponentialRampToValueAtTime(100,n.currentTime+.15),e.gain.value=.1,e.gain.exponentialRampToValueAtTime(.001,n.currentTime+.15),t.connect(e),e.connect(n.destination),t.start(n.currentTime),t.stop(n.currentTime+.15),setTimeout(()=>{const i=n.createOscillator(),s=n.createGain();i.type="sine",i.frequency.value=100,i.frequency.exponentialRampToValueAtTime(600,n.currentTime+.1),s.gain.value=.1,s.gain.exponentialRampToValueAtTime(.001,n.currentTime+.12),i.connect(s),s.connect(n.destination),i.start(n.currentTime),i.stop(n.currentTime+.12)},100)},electric(){const n=b();for(let t=0;t<4;t++)setTimeout(()=>{const e=n.createOscillator(),i=n.createGain();e.type="square",e.frequency.value=800+Math.random()*1200,i.gain.value=.06,i.gain.exponentialRampToValueAtTime(.001,n.currentTime+.05),e.connect(i),i.connect(n.destination),e.start(n.currentTime),e.stop(n.currentTime+.05)},t*30);R(.12,.08)},heavyImpact(){u(50,.2,"sine",.25),u(100,.15,"square",.12),R(.12,.15)},iceSlide(){const n=b(),t=n.createOscillator(),e=n.createGain();t.type="triangle",t.frequency.value=1200,t.frequency.exponentialRampToValueAtTime(400,n.currentTime+.2),e.gain.value=.06,e.gain.exponentialRampToValueAtTime(.001,n.currentTime+.25),t.connect(e),e.connect(n.destination),t.start(n.currentTime),t.stop(n.currentTime+.25),R(.15,.04)},flurryHit(){u(300+Math.random()*200,.04,"square",.08),R(.03,.06)},risingAttack(){const n=b(),t=n.createOscillator(),e=n.createGain();t.type="sawtooth",t.frequency.value=200,t.frequency.exponentialRampToValueAtTime(800,n.currentTime+.15),e.gain.value=.1,e.gain.exponentialRampToValueAtTime(.001,n.currentTime+.2),t.connect(e),e.connect(n.destination),t.start(n.currentTime),t.stop(n.currentTime+.2)}};class J extends f.Scene{constructor(){super("TitleScene")}create(){this.add.text(640,160,"STICK FIGHTER",{fontSize:"72px",fontFamily:"monospace",color:"#ffffff",fontStyle:"bold"}).setOrigin(.5),this.add.text(640,240,"A game of sticks and honor",{fontSize:"20px",fontFamily:"monospace",color:"#888888"}).setOrigin(.5);const t=this.add.graphics();new T(t).draw(440,480,w.IDLE[0],!0,16777215);const i=this.add.graphics();new T(i).draw(840,480,w.IDLE[0],!1,65535),this.add.text(640,560,"P1: WASD + J/K/L    P2: Arrows + , . -",{fontSize:"16px",fontFamily:"monospace",color:"#666666"}).setOrigin(.5),this.add.text(640,585,"Gamepads supported!",{fontSize:"14px",fontFamily:"monospace",color:"#555555"}).setOrigin(.5),this.promptText=this.add.text(640,650,"Press ENTER or SPACE to fight!",{fontSize:"24px",fontFamily:"monospace",color:"#ffcc00"}).setOrigin(.5),this.tweens.add({targets:this.promptText,alpha:.3,duration:600,yoyo:!0,repeat:-1}),this.input.keyboard.on("keydown-ENTER",this.startGame,this),this.input.keyboard.on("keydown-SPACE",this.startGame,this),this.input.gamepad.on("down",(a,o)=>{this.startGame()})}startGame(){p.menuSelect(),this.scene.start("CharacterSelectScene")}}const k=[{id:"swift",name:"Swift",color:16777215,description:"Balanced fighter with a quick lunge.",moveSpeed:300,jumpVelocity:-650,punchDamage:8,punchRange:60,kickDamage:14,kickRange:80,specialDamage:22,specialRange:100,specialType:"lunge",specialName:"Dash Strike",specialDuration:500},{id:"titan",name:"Titan",color:65535,description:"Slow powerhouse. Ground pound shakes the arena.",moveSpeed:220,jumpVelocity:-520,punchDamage:11,punchRange:65,kickDamage:19,kickRange:85,specialDamage:28,specialRange:120,specialType:"groundPound",specialName:"Ground Pound",specialDuration:900},{id:"shadow",name:"Shadow",color:12272895,description:"Fragile but lightning fast. Teleports behind foes.",moveSpeed:380,jumpVelocity:-700,punchDamage:7,punchRange:55,kickDamage:12,kickRange:75,specialDamage:18,specialRange:60,specialType:"teleport",specialName:"Shadow Step",specialDuration:550,maxHealth:80},{id:"blaze",name:"Blaze",color:16737792,description:"Aggressive brawler with a fiery uppercut.",moveSpeed:280,jumpVelocity:-620,punchDamage:9,punchRange:58,kickDamage:15,kickRange:78,specialDamage:24,specialRange:70,specialType:"uppercut",specialName:"Fire Uppercut",specialDuration:650},{id:"frost",name:"Frost",color:6737151,description:"Cool and collected. Ice slide covers distance fast.",moveSpeed:260,jumpVelocity:-600,punchDamage:8,punchRange:60,kickDamage:14,kickRange:80,specialDamage:20,specialRange:130,specialType:"slide",specialName:"Ice Slide",specialDuration:550},{id:"thunder",name:"Thunder",color:16776960,description:"Electrifying strikes. Lightning drop from above.",moveSpeed:270,jumpVelocity:-680,punchDamage:9,punchRange:60,kickDamage:16,kickRange:82,specialDamage:26,specialRange:90,specialType:"lightningDrop",specialName:"Lightning Drop",specialDuration:800},{id:"viper",name:"Viper",color:4521796,description:"Quick multi-hit combos. Rapid dash flurry.",moveSpeed:330,jumpVelocity:-640,punchDamage:6,punchRange:55,kickDamage:10,kickRange:70,specialDamage:8,specialRange:80,specialType:"flurry",specialName:"Viper Flurry",specialHits:4,specialDuration:700},{id:"golem",name:"Golem",color:11176021,description:"Immovable wall. Absorbs a hit during special.",moveSpeed:180,jumpVelocity:-450,punchDamage:13,punchRange:70,kickDamage:22,kickRange:90,specialDamage:30,specialRange:90,specialType:"armorSmash",specialName:"Armor Smash",specialDuration:800,maxHealth:120},{id:"phantom",name:"Phantom",color:14540287,description:"Floaty and evasive. Spinning whirlwind attack.",moveSpeed:290,jumpVelocity:-750,punchDamage:7,punchRange:55,kickDamage:12,kickRange:75,specialDamage:16,specialRange:110,specialType:"whirlwind",specialName:"Whirlwind",specialDuration:650},{id:"nova",name:"Nova",color:16724838,description:"Glass cannon. Massive explosive burst.",moveSpeed:260,jumpVelocity:-600,punchDamage:10,punchRange:58,kickDamage:16,kickRange:78,specialDamage:38,specialRange:140,specialType:"explosion",specialName:"Nova Burst",specialDuration:700,maxHealth:70}],m=5,M=2,g=200,S=180,_=140,E=120;class q extends f.Scene{constructor(){super("CharacterSelectScene")}create(){this.p1Index=0,this.p2Index=1,this.p1Locked=!1,this.p2Locked=!1,this.add.text(640,40,"SELECT YOUR FIGHTER",{fontSize:"36px",fontFamily:"monospace",color:"#ffffff",fontStyle:"bold"}).setOrigin(.5),this.add.text(640,80,"P1: WASD + J to lock    P2: Arrows + , to lock",{fontSize:"14px",fontFamily:"monospace",color:"#666666"}).setOrigin(.5),this.cellGraphics=[],this.cellTexts=[];for(let t=0;t<k.length;t++){const e=t%m,i=Math.floor(t/m),s=_+e*g+g/2,a=E+i*S+S/2,o=k[t],h=this.add.graphics();this.cellGraphics.push(h);const r=this.add.text(s,a+50,o.name,{fontSize:"14px",fontFamily:"monospace",color:"#aaaaaa"}).setOrigin(.5);this.cellTexts.push(r);const c=this.add.graphics();new T(c).draw(s,a+20,w.IDLE[0],!0,o.color)}this.p1Info=this.add.text(200,520,"",{fontSize:"16px",fontFamily:"monospace",color:"#ffffff",wordWrap:{width:350}}).setOrigin(.5,0),this.p2Info=this.add.text(1080,520,"",{fontSize:"16px",fontFamily:"monospace",color:"#ffffff",wordWrap:{width:350}}).setOrigin(.5,0),this.add.text(200,495,"PLAYER 1",{fontSize:"20px",fontFamily:"monospace",color:"#ffcc00",fontStyle:"bold"}).setOrigin(.5),this.add.text(1080,495,"PLAYER 2",{fontSize:"20px",fontFamily:"monospace",color:"#ffcc00",fontStyle:"bold"}).setOrigin(.5),this.p1LockText=this.add.text(200,660,"",{fontSize:"18px",fontFamily:"monospace",color:"#00ff00"}).setOrigin(.5),this.p2LockText=this.add.text(1080,660,"",{fontSize:"18px",fontFamily:"monospace",color:"#00ff00"}).setOrigin(.5),this.startText=this.add.text(640,690,"",{fontSize:"20px",fontFamily:"monospace",color:"#ffcc00"}).setOrigin(.5),this.highlightGraphics=this.add.graphics(),this.highlightGraphics.setDepth(50),this.p1Keys={up:this.input.keyboard.addKey("W"),down:this.input.keyboard.addKey("S"),left:this.input.keyboard.addKey("A"),right:this.input.keyboard.addKey("D"),confirm:this.input.keyboard.addKey("J"),cancel:this.input.keyboard.addKey("K")},this.p2Keys={up:this.input.keyboard.addKey("UP"),down:this.input.keyboard.addKey("DOWN"),left:this.input.keyboard.addKey("LEFT"),right:this.input.keyboard.addKey("RIGHT"),confirm:this.input.keyboard.addKey("COMMA"),cancel:this.input.keyboard.addKey("PERIOD")},this.p1PadPrev={},this.p2PadPrev={},this.updateDisplay()}update(){this.p1Locked?(f.Input.Keyboard.JustDown(this.p1Keys.cancel)||this.padJustPressed(1,"B"))&&this.unlock(1):((f.Input.Keyboard.JustDown(this.p1Keys.left)||this.padJustPressed(1,"left"))&&this.moveSelection(1,-1,0),(f.Input.Keyboard.JustDown(this.p1Keys.right)||this.padJustPressed(1,"right"))&&this.moveSelection(1,1,0),(f.Input.Keyboard.JustDown(this.p1Keys.up)||this.padJustPressed(1,"up"))&&this.moveSelection(1,0,-1),(f.Input.Keyboard.JustDown(this.p1Keys.down)||this.padJustPressed(1,"down"))&&this.moveSelection(1,0,1),(f.Input.Keyboard.JustDown(this.p1Keys.confirm)||this.padJustPressed(1,"A"))&&this.lockIn(1)),this.p2Locked?(f.Input.Keyboard.JustDown(this.p2Keys.cancel)||this.padJustPressed(2,"B"))&&this.unlock(2):((f.Input.Keyboard.JustDown(this.p2Keys.left)||this.padJustPressed(2,"left"))&&this.moveSelection(2,-1,0),(f.Input.Keyboard.JustDown(this.p2Keys.right)||this.padJustPressed(2,"right"))&&this.moveSelection(2,1,0),(f.Input.Keyboard.JustDown(this.p2Keys.up)||this.padJustPressed(2,"up"))&&this.moveSelection(2,0,-1),(f.Input.Keyboard.JustDown(this.p2Keys.down)||this.padJustPressed(2,"down"))&&this.moveSelection(2,0,1),(f.Input.Keyboard.JustDown(this.p2Keys.confirm)||this.padJustPressed(2,"A"))&&this.lockIn(2)),this.updatePadPrev()}getPad(t){if(!this.input.gamepad)return null;const e=this.input.gamepad.gamepads.filter(s=>s&&s.connected),i=t-1;return e.find(s=>s.index===i)||null}padJustPressed(t,e){const i=this.getPad(t),s=t===1?this.p1PadPrev:this.p2PadPrev;if(!i)return!1;const a=.5,o=i.leftStick?i.leftStick.x:0,h=i.leftStick?i.leftStick.y:0;let r=!1;switch(e){case"left":r=i.left||o<-a;break;case"right":r=i.right||o>a;break;case"up":r=i.up||h<-a;break;case"down":r=i.down||h>a;break;case"A":r=i.A;break;case"B":r=i.B;break}return r&&!s[e]}updatePadPrev(){for(const t of[1,2]){const e=this.getPad(t),i=t===1?this.p1PadPrev:this.p2PadPrev;if(!e)continue;const s=.5,a=e.leftStick?e.leftStick.x:0,o=e.leftStick?e.leftStick.y:0;i.left=e.left||a<-s,i.right=e.right||a>s,i.up=e.up||o<-s,i.down=e.down||o>s,i.A=e.A,i.B=e.B}}moveSelection(t,e,i){const s=t===1?this.p1Index:this.p2Index;let a=s%m,o=Math.floor(s/m);a+=e,o+=i,a<0&&(a=m-1),a>=m&&(a=0),o<0&&(o=M-1),o>=M&&(o=0);const h=o*m+a;h>=0&&h<k.length&&(t===1?this.p1Index=h:this.p2Index=h,p.menuSelect(),this.updateDisplay())}lockIn(t){t===1?this.p1Locked=!0:this.p2Locked=!0,p.roundStart(),this.updateDisplay(),this.p1Locked&&this.p2Locked&&this.time.delayedCall(500,()=>this.startFight())}unlock(t){t===1?this.p1Locked=!1:this.p2Locked=!1,p.block(),this.updateDisplay()}updateDisplay(){const t=this.highlightGraphics;t.clear();for(let L=0;L<k.length;L++){const C=L%m,P=Math.floor(L/m),O=_+C*g,K=E+P*S,D=this.cellGraphics[L];D.clear(),D.fillStyle(1710654,.6),D.fillRect(O+4,K+4,g-8,S-8),D.lineStyle(1,3355494,.8),D.strokeRect(O+4,K+4,g-8,S-8)}const e=this.p1Index%m,i=Math.floor(this.p1Index/m),s=_+e*g,a=E+i*S;t.lineStyle(3,this.p1Locked?65280:16763904,1),t.strokeRect(s+2,a+2,g-4,S-4),t.fillStyle(this.p1Locked?65280:16763904,1),t.fillTriangle(s+10,a+8,s+22,a+8,s+16,a+18),t.fillStyle(0,1),this.add.text;const o=this.p2Index%m,h=Math.floor(this.p2Index/m),r=_+o*g,c=E+h*S;t.lineStyle(3,this.p2Locked?65280:52479,1),t.strokeRect(r+6,c+6,g-12,S-12),t.fillStyle(this.p2Locked?65280:52479,1),t.fillTriangle(r+g-10,c+8,r+g-22,c+8,r+g-16,c+18);const y=k[this.p1Index],x=k[this.p2Index];this.p1Info.setText(`${y.name}
${y.description}

SPD: ${"|".repeat(Math.round(y.moveSpeed/40))}  HP: ${y.maxHealth||100}
Special: ${y.specialName}`),this.p1Info.setColor(`#${y.color.toString(16).padStart(6,"0")}`),this.p2Info.setText(`${x.name}
${x.description}

SPD: ${"|".repeat(Math.round(x.moveSpeed/40))}  HP: ${x.maxHealth||100}
Special: ${x.specialName}`),this.p2Info.setColor(`#${x.color.toString(16).padStart(6,"0")}`),this.p1LockText.setText(this.p1Locked?"LOCKED IN!":""),this.p2LockText.setText(this.p2Locked?"LOCKED IN!":""),this.p1Locked&&this.p2Locked?this.startText.setText("GET READY..."):this.startText.setText("")}startFight(){this.registry.set("p1Fighter",this.p1Index),this.registry.set("p2Fighter",this.p2Index),this.registry.set("p1Wins",0),this.registry.set("p2Wins",0),this.registry.set("currentRound",1),this.scene.start("FightScene")}}function j(n,t,e,i,s,a=5){const o=n.add.graphics().setDepth(8);for(let h=0;h<a;h++){const r=e-30+Math.random()*60,c=t-i*(10+h*12),y=20+Math.random()*25;o.lineStyle(2,s,.6-h*.08),o.lineBetween(c,r,c-i*y,r)}n.tweens.add({targets:o,alpha:0,duration:200,onComplete:()=>o.destroy()})}function I(n,t,e,i=11184810){const s=n.add.graphics().setDepth(8);for(let a=0;a<6;a++){const o=Math.random()*Math.PI*2,h=5+Math.random()*15,r=3+Math.random()*4;s.fillStyle(i,.4),s.fillCircle(t+Math.cos(o)*h,e+Math.sin(o)*h,r)}n.tweens.add({targets:s,alpha:0,duration:400,onComplete:()=>s.destroy()})}function H(n,t,e,i,s=80){const a=n.add.graphics().setDepth(12);n.tweens.addCounter({from:10,to:s,duration:400,onUpdate:o=>{a.clear();const h=o.getValue(),r=(h-10)/(s-10);a.lineStyle(3,i,(1-r)*.8),a.strokeCircle(t,e,h),a.lineStyle(2,16777215,(1-r)*.4),a.strokeCircle(t,e,h*.6)},onComplete:()=>a.destroy()})}function $(n,t,e,i=16737792,s=8){const a=n.add.graphics().setDepth(8),o=[];for(let h=0;h<s;h++)o.push({x:t+(Math.random()-.5)*20,y:e+(Math.random()-.5)*20,vx:(Math.random()-.5)*80,vy:-100-Math.random()*150,size:2+Math.random()*4});n.tweens.addCounter({from:0,to:1,duration:500,onUpdate:h=>{a.clear();const r=h.getValue();o.forEach(c=>{c.x+=c.vx*.016,c.y+=c.vy*.016,c.vy+=120*.016,a.fillStyle(i,1-r),a.fillCircle(c.x,c.y,c.size*(1-r*.5)),a.fillStyle(16776960,(1-r)*.5),a.fillCircle(c.x,c.y,c.size*.4)})},onComplete:()=>a.destroy()})}function Z(n,t,e,i,s=16737792){const a=n.add.graphics().setDepth(7);for(let o=0;o<4;o++){const h=t-i*(o*8)+(Math.random()-.5)*10,r=e+(Math.random()-.5)*15,c=3+Math.random()*5;a.fillStyle(s,.6),a.fillCircle(h,r,c),a.fillStyle(16777028,.3),a.fillCircle(h,r,c*.5)}n.tweens.add({targets:a,alpha:0,duration:250,onComplete:()=>a.destroy()})}function Q(n,t,e,i,s=6737151){const a=n.add.graphics().setDepth(5);for(let o=0;o<6;o++){const h=t-i*o*18+(Math.random()-.5)*8,r=e+(Math.random()-.5)*6,c=3+Math.random()*5;a.fillStyle(s,.6),a.fillTriangle(h,r-c,h-c*.6,r,h+c*.6,r),a.fillTriangle(h,r+c,h-c*.6,r,h+c*.6,r),a.fillStyle(16777215,.3),a.fillCircle(h,r-c*.3,1.5)}n.tweens.add({targets:a,alpha:0,duration:600,onComplete:()=>a.destroy()})}function tt(n,t,e,i=6737151){const s=n.add.graphics().setDepth(12),a=[];for(let o=0;o<6;o++){const h=Math.random()*Math.PI*2,r=60+Math.random()*100;a.push({x:t,y:e,vx:Math.cos(h)*r,vy:Math.sin(h)*r-40,size:2+Math.random()*3})}n.tweens.addCounter({from:0,to:1,duration:400,onUpdate:o=>{s.clear();const h=o.getValue();a.forEach(r=>{r.x+=r.vx*.016,r.y+=r.vy*.016,s.fillStyle(i,1-h),s.fillCircle(r.x,r.y,r.size)})},onComplete:()=>s.destroy()})}function et(n,t,e,i,s,a=16776960){const o=n.add.graphics().setDepth(15),h=8,r=[{x:t,y:e}];for(let c=1;c<h;c++){const y=c/h;r.push({x:t+(i-t)*y+(Math.random()-.5)*40,y:e+(s-e)*y+(Math.random()-.5)*10})}r.push({x:i,y:s}),o.lineStyle(8,a,.3);for(let c=0;c<r.length-1;c++)o.lineBetween(r[c].x,r[c].y,r[c+1].x,r[c+1].y);o.lineStyle(3,a,1);for(let c=0;c<r.length-1;c++)o.lineBetween(r[c].x,r[c].y,r[c+1].x,r[c+1].y);o.lineStyle(1,16777215,.9);for(let c=0;c<r.length-1;c++)o.lineBetween(r[c].x,r[c].y,r[c+1].x,r[c+1].y);n.tweens.add({targets:o,alpha:0,duration:150,onComplete:()=>o.destroy()})}function v(n,t,e,i=16776960,s=10){const a=n.add.graphics().setDepth(12),o=[];for(let h=0;h<s;h++){const r=Math.random()*Math.PI*2,c=100+Math.random()*200;o.push({x:t,y:e,vx:Math.cos(r)*c,vy:Math.sin(r)*c-50,len:4+Math.random()*8})}n.tweens.addCounter({from:0,to:1,duration:300,onUpdate:h=>{a.clear();const r=h.getValue();o.forEach(c=>{c.x+=c.vx*.016,c.y+=c.vy*.016;const y=Math.atan2(c.vy,c.vx);a.lineStyle(2,i,1-r),a.lineBetween(c.x,c.y,c.x-Math.cos(y)*c.len,c.y-Math.sin(y)*c.len)})},onComplete:()=>a.destroy()})}function it(n,t,e,i,s=4521796){const a=n.add.graphics().setDepth(12),o=t+i*35,h=Math.random()*.5-.25,r=20+Math.random()*15;a.lineStyle(3,s,.9),a.lineBetween(o-Math.cos(h)*r,e-Math.sin(h)*r,o+Math.cos(h)*r,e+Math.sin(h)*r),a.lineStyle(1,16777215,.6),a.lineBetween(o-Math.cos(h)*r,e-Math.sin(h)*r,o+Math.cos(h)*r,e+Math.sin(h)*r),n.tweens.add({targets:a,alpha:0,duration:120,onComplete:()=>a.destroy()})}function st(n,t,e,i=11176021,s=40){const a=n.add.graphics().setDepth(7);a.fillStyle(i,.15),a.fillCircle(t,e,s),a.lineStyle(3,i,.6),a.strokeCircle(t,e,s),a.lineStyle(6,i,.2),a.strokeCircle(t,e,s+5),n.tweens.add({targets:a,alpha:0,duration:200,onComplete:()=>a.destroy()})}function at(n,t,e,i,s=14540287){const a=n.add.graphics().setDepth(8),o=40;for(let h=0;h<3;h++){const r=i+h*Math.PI*2/3;a.lineStyle(3,s,.7),a.beginPath(),a.arc(t,e,o+h*6,r,r+Math.PI*.6),a.strokePath()}for(let h=0;h<4;h++){const r=i*.5+h*Math.PI/2,c=o+12+Math.random()*10;a.fillStyle(11184810,.3),a.fillCircle(t+Math.cos(r)*c,e+Math.sin(r)*c,2)}n.tweens.add({targets:a,alpha:0,duration:120,onComplete:()=>a.destroy()})}function ot(n,t,e,i,s){const a=n.add.graphics().setDepth(8);a.fillStyle(i,.15),a.fillCircle(t,e,s),a.lineStyle(2,i,.5),a.strokeCircle(t,e,s),a.fillStyle(16777215,.2),a.fillCircle(t,e,s*.3),n.tweens.add({targets:a,alpha:0,duration:80,onComplete:()=>a.destroy()})}function nt(n,t,e,i,s=120){const a=n.add.graphics().setDepth(100);a.fillStyle(i,.3),a.fillRect(0,0,1280,720),n.tweens.add({targets:a,alpha:0,duration:200,onComplete:()=>a.destroy()});const o=n.add.graphics().setDepth(15);n.tweens.addCounter({from:5,to:s,duration:400,onUpdate:h=>{o.clear();const r=h.getValue(),c=(r-5)/(s-5);o.lineStyle(4,i,(1-c)*.9),o.strokeCircle(t,e,r),o.lineStyle(2,16777215,(1-c)*.6),o.strokeCircle(t,e,r*.7);for(let y=0;y<8;y++){const x=y/8*Math.PI*2+c*3;o.fillStyle(i,(1-c)*.7),o.fillCircle(t+Math.cos(x)*r,e+Math.sin(x)*r,3)}},onComplete:()=>o.destroy()})}function ht(n,t,e,i=12272895){const s=n.add.graphics().setDepth(12);n.tweens.addCounter({from:0,to:1,duration:400,onUpdate:a=>{s.clear();const o=a.getValue();for(let h=0;h<8;h++){const r=h/8*Math.PI*2,c=o*25,y=6+o*8;s.fillStyle(i,(1-o)*.5),s.fillCircle(t+Math.cos(r)*c,e+Math.sin(r)*c,y*(1-o*.3))}},onComplete:()=>s.destroy()})}function rt(n,t,e,i=12272895){const s=n.add.graphics().setDepth(15);s.fillStyle(16777215,.8),s.fillCircle(t,e,15),s.fillStyle(i,.5),s.fillCircle(t,e,30);for(let a=0;a<6;a++){const o=a/6*Math.PI*2;s.lineStyle(2,i,.7),s.lineBetween(t,e,t+Math.cos(o)*35,e+Math.sin(o)*35)}n.tweens.add({targets:s,alpha:0,duration:250,onComplete:()=>s.destroy()})}function B(n,t,e,i=8947848){const s=n.add.graphics().setDepth(3);for(let a=0;a<5;a++){const o=-Math.PI*.8+a/4*Math.PI*.6,h=25+Math.random()*35,r=t+Math.cos(o)*h*.5+(Math.random()-.5)*8,c=e+Math.abs(Math.sin(o))*h*.2,y=t+Math.cos(o)*h+(Math.random()-.5)*12,x=e+Math.abs(Math.sin(o))*h*.15;s.lineStyle(2,i,.7),s.lineBetween(t,e,r,c),s.lineBetween(r,c,y,x)}n.tweens.add({targets:s,alpha:0,duration:1200,onComplete:()=>s.destroy()})}const l={IDLE:"IDLE",WALK_FORWARD:"WALK_FORWARD",WALK_BACKWARD:"WALK_BACKWARD",JUMP:"JUMP",PUNCH:"PUNCH",KICK:"KICK",SPECIAL:"SPECIAL",BLOCK:"BLOCK",HIT:"HIT",KO:"KO",VICTORY:"VICTORY"};class N{constructor(t,e,i,s,a,o){this.scene=t,this.playerIndex=s,this.facingRight=a,this.data=o,this.state=l.IDLE,this.maxHealth=o.maxHealth||d.MAX_HEALTH,this.health=this.maxHealth,this.stateTimer=0,this.specialCooldown=0,this.canAct=!0,this.hasHit=!1,this.specialHitCount=0,this.armorActive=!1,this._effectPhase=0,this._effectTimer=0,this.attackCooldown=0,this.lastAttackType=null,this.sameAttackCount=0,this.timeSinceLastAttack=0,this.body=t.add.zone(e,i-d.BODY_HEIGHT/2,d.BODY_WIDTH,d.BODY_HEIGHT),t.physics.add.existing(this.body),this.body.body.setCollideWorldBounds(!0),this.graphics=t.add.graphics(),this.graphics.setDepth(10),this.renderer=new T(this.graphics),this.animFrame=0,this.animTimer=0}get x(){return this.body.x}get y(){return this.body.y}get isGrounded(){return this.body.body.blocked.down}get specialDuration(){return this.data.specialDuration||d.SPECIAL_DURATION}update(t,e){this.stateTimer+=t,this.animTimer+=t,this.specialCooldown=Math.max(0,this.specialCooldown-t),this.attackCooldown=Math.max(0,this.attackCooldown-t),this.timeSinceLastAttack+=t,this.timeSinceLastAttack>d.STALE_MOVE_RESET_TIME&&(this.sameAttackCount=0),this.canAct&&this.state!==l.KO&&this.state!==l.VICTORY&&this.handleInput(e),this.updateState(t),this.draw()}handleInput(t){if(!this.canAct)return;const e=[l.IDLE,l.WALK_FORWARD,l.WALK_BACKWARD,l.BLOCK].includes(this.state),i=!this.isGrounded;if((e||i&&this.state===l.JUMP)&&this.attackCooldown<=0){if(t.special&&this.specialCooldown<=0&&this.isGrounded){this.enterState(l.SPECIAL),this.specialCooldown=d.SPECIAL_COOLDOWN;return}if(t.punch){this.enterState(l.PUNCH);return}if(t.kick){this.enterState(l.KICK);return}}if(t.block&&this.isGrounded&&e){this.state!==l.BLOCK&&this.enterState(l.BLOCK);return}if(this.state===l.BLOCK&&!t.block&&this.enterState(l.IDLE),t.jump&&this.isGrounded&&e){this.body.body.setVelocityY(this.data.jumpVelocity),this.enterState(l.JUMP);return}if(this.state!==l.BLOCK&&this.state!==l.JUMP)if(t.left){if(this.body.body.setVelocityX(-this.data.moveSpeed),this.isGrounded){const s=!this.facingRight;this.state=s?l.WALK_FORWARD:l.WALK_BACKWARD}}else if(t.right){if(this.body.body.setVelocityX(this.data.moveSpeed),this.isGrounded){const s=this.facingRight;this.state=s?l.WALK_FORWARD:l.WALK_BACKWARD}}else this.isGrounded&&e&&(this.body.body.setVelocityX(0),this.state!==l.IDLE&&(this.state=l.IDLE));this.state===l.JUMP&&(t.left?this.body.body.setVelocityX(-this.data.moveSpeed*.7):t.right&&this.body.body.setVelocityX(this.data.moveSpeed*.7))}updateState(t){switch(this.state){case l.PUNCH:this.stateTimer>=d.PUNCH_DURATION&&(this.canAct=!0,this.hasHit=!1,this.attackCooldown=d.PUNCH_RECOVERY,this.enterState(l.IDLE));break;case l.KICK:this.stateTimer>=d.KICK_DURATION&&(this.canAct=!0,this.hasHit=!1,this.attackCooldown=d.KICK_RECOVERY,this.enterState(l.IDLE));break;case l.SPECIAL:this.updateSpecial(t),this.stateTimer>=this.specialDuration&&(this.canAct=!0,this.hasHit=!1,this.specialHitCount=0,this.armorActive=!1,this._effectPhase=0,this._effectTimer=0,this.attackCooldown=d.SPECIAL_RECOVERY,this.body.body.setVelocityX(0),this.enterState(l.IDLE));break;case l.HIT:this.stateTimer>=d.HITSTUN_DURATION&&(this.canAct=!0,this.enterState(l.IDLE));break;case l.JUMP:this.isGrounded&&this.stateTimer>100&&(this.body.body.setVelocityX(0),this.enterState(l.IDLE));break;case l.KO:if(this.stateTimer<500){const e=this.facingRight?-1:1;this.body.body.setVelocityX(e*100)}else this.body.body.setVelocityX(0);break}}updateSpecial(t){const e=this.stateTimer,i=this.specialDuration,s=this.facingRight?1:-1,a=d.BODY_HEIGHT,o=this.y+a/2;switch(this._effectTimer+=t,this.data.specialType){case"lunge":e>i*.2&&e<i*.7&&(this.body.body.setVelocityX(s*550),this._effectTimer>50&&(this._effectTimer=0,j(this.scene,this.x,this.y,s,this.data.color,4))),this._effectPhase<1&&e>i*.15&&(this._effectPhase=1,I(this.scene,this.x-s*20,o),p.whoosh());break;case"groundPound":e>i*.05&&e<i*.3&&this.body.body.setVelocityY(-600),e>i*.4&&e<i*.65&&(this.body.body.setVelocityY(1e3),this.body.body.setVelocityX(0)),this._effectPhase<1&&e>i*.05&&(this._effectPhase=1,I(this.scene,this.x,o,8947848)),this._effectPhase<2&&e>i*.55&&this.isGrounded&&(this._effectPhase=2,H(this.scene,this.x,o,this.data.color,100),B(this.scene,this.x,o),I(this.scene,this.x-30,o,6710886),I(this.scene,this.x+30,o,6710886),this.scene.cameras.main.shake(250,.02),p.heavyImpact());break;case"teleport":if(this._effectPhase<1&&e>i*.15&&(this._effectPhase=1,ht(this.scene,this.x,this.y,this.data.color),p.warp()),e>i*.3&&e<i*.35&&this.opponent){const h=this.opponent.x+(this.opponent.facingRight?-70:70);this.body.setPosition(f.Math.Clamp(h,d.STAGE_LEFT+30,d.STAGE_RIGHT-30),this.body.y)}this._effectPhase<2&&e>i*.35&&(this._effectPhase=2,rt(this.scene,this.x,this.y,this.data.color));break;case"uppercut":e>i*.2&&e<i*.5&&(this.body.body.setVelocityY(-700),this.body.body.setVelocityX(s*180),this._effectTimer>40&&(this._effectTimer=0,Z(this.scene,this.x,this.y+20,s,this.data.color))),this._effectPhase<1&&e>i*.15&&(this._effectPhase=1,$(this.scene,this.x+s*20,this.y,this.data.color,10),p.risingAttack());break;case"slide":e>i*.15&&e<i*.7&&(this.body.body.setVelocityX(s*600),this._effectTimer>60&&(this._effectTimer=0,Q(this.scene,this.x,o,s,this.data.color))),this._effectPhase<1&&e>i*.1&&(this._effectPhase=1,tt(this.scene,this.x,o,this.data.color),p.iceSlide());break;case"lightningDrop":e<i*.25&&(this.body.body.setVelocityY(-700),this.body.body.setVelocityX(s*120),this._effectTimer>60&&(this._effectTimer=0,v(this.scene,this.x,this.y,this.data.color,4))),e>i*.35&&e<i*.65&&(this.body.body.setVelocityY(1e3),this.body.body.setVelocityX(0)),this._effectPhase<1&&e>i*.5&&this.isGrounded&&(this._effectPhase=1,et(this.scene,this.x,0,this.x,o,this.data.color),v(this.scene,this.x,o,this.data.color,12),H(this.scene,this.x,o,this.data.color,60),this.scene.cameras.main.shake(150,.012),p.electric());break;case"flurry":if(e>i*.12&&e<i*.8){this.body.body.setVelocityX(s*280);const h=i*.68/(this.data.specialHits||4),r=e-i*.12,c=Math.floor(r/h);c>this.specialHitCount&&(this.specialHitCount=c,this.hasHit=!1,it(this.scene,this.x,this.y,s,this.data.color),p.flurryHit())}break;case"armorSmash":e<i*.5?(this.armorActive=!0,this._effectTimer>100&&(this._effectTimer=0,st(this.scene,this.x,this.y,this.data.color,45))):this.armorActive=!1,e>i*.45&&e<i*.65&&this.body.body.setVelocityX(s*400),this._effectPhase<1&&e>i*.5&&(this._effectPhase=1,B(this.scene,this.x+s*40,o,this.data.color),I(this.scene,this.x+s*40,o,8947848),this.scene.cameras.main.shake(150,.01),p.heavyImpact());break;case"whirlwind":if(e>i*.1&&e<i*.75&&(this.body.body.setVelocityX(s*180),this._effectTimer>50)){this._effectTimer=0;const h=e/i*Math.PI*8;at(this.scene,this.x,this.y,h,this.data.color)}this._effectPhase<1&&e>i*.1&&(this._effectPhase=1,p.whoosh());break;case"explosion":if(e<i*.55){this.body.body.setVelocityX(0);const h=e/(i*.55);this._effectTimer>60&&(this._effectTimer=0,ot(this.scene,this.x,this.y,this.data.color,10+h*35))}this._effectPhase<1&&e>i*.55&&(this._effectPhase=1,nt(this.scene,this.x,this.y,this.data.color,130),this.scene.cameras.main.shake(300,.025),p.boom()),e>i*.6&&e<i*.7&&this.body.body.setVelocityX(-s*150);break}}enterState(t){switch(this.state=t,this.stateTimer=0,this.animFrame=0,this.animTimer=0,t){case l.PUNCH:p.punch();break;case l.KICK:p.kick();break;case l.SPECIAL:p.special();break;case l.JUMP:p.jump();break}if([l.PUNCH,l.KICK,l.SPECIAL].includes(t)){this.canAct=!1,this.hasHit=!1;const e=t;e===this.lastAttackType&&this.timeSinceLastAttack<d.STALE_MOVE_RESET_TIME?this.sameAttackCount++:this.sameAttackCount=1,this.lastAttackType=e,this.timeSinceLastAttack=0}t===l.SPECIAL&&(this._effectPhase=0,this._effectTimer=0),t===l.HIT&&(this.canAct=!1),t===l.BLOCK&&this.body.body.setVelocityX(0)}isAttacking(){return[l.PUNCH,l.KICK,l.SPECIAL].includes(this.state)}isOnActiveFrame(){if(!this.isAttacking())return!1;let t,e,i;switch(this.state){case l.PUNCH:t=d.PUNCH_DURATION,e=t*.3,i=t*.6;break;case l.KICK:t=d.KICK_DURATION,e=t*.25,i=t*.6;break;case l.SPECIAL:switch(t=this.specialDuration,this.data.specialType){case"lunge":e=t*.25,i=t*.65;break;case"groundPound":e=t*.5,i=t*.7;break;case"teleport":e=t*.4,i=t*.7;break;case"uppercut":e=t*.2,i=t*.5;break;case"slide":e=t*.2,i=t*.7;break;case"lightningDrop":e=t*.45,i=t*.65;break;case"flurry":e=t*.12,i=t*.8;break;case"armorSmash":e=t*.5,i=t*.7;break;case"whirlwind":e=t*.12,i=t*.75;break;case"explosion":e=t*.55,i=t*.75;break;default:e=t*.2,i=t*.6}break;default:return!1}return this.stateTimer>=e&&this.stateTimer<=i}getStaleDamageMultiplier(){if(this.sameAttackCount<=1)return 1;const t=d.STALE_MOVE_PENALTY*(this.sameAttackCount-1);return Math.max(d.STALE_MOVE_MIN,1-t)}getAttackData(){const t=this.getStaleDamageMultiplier();switch(this.state){case l.PUNCH:return{damage:Math.round(this.data.punchDamage*t),range:this.data.punchRange,knockback:d.PUNCH_KNOCKBACK};case l.KICK:return{damage:Math.round(this.data.kickDamage*t),range:this.data.kickRange,knockback:d.KICK_KNOCKBACK};case l.SPECIAL:return{damage:Math.round(this.data.specialDamage*t),range:this.data.specialRange,knockback:d.SPECIAL_KNOCKBACK};default:return null}}getHitboxRect(){const t=this.getAttackData();if(!t)return null;const e=this.facingRight?1:-1,i=this.x,s=this.y;if(this.state===l.SPECIAL)switch(this.data.specialType){case"explosion":return new f.Geom.Rectangle(i-t.range/2,s-t.range/3,t.range,t.range*.66);case"groundPound":return new f.Geom.Rectangle(i-t.range/2,s-20,t.range,60);case"whirlwind":return new f.Geom.Rectangle(i-t.range/2,s-30,t.range,60)}const a=e>0?i+d.BODY_WIDTH/2:i-d.BODY_WIDTH/2-t.range;return new f.Geom.Rectangle(a,s-25,t.range,50)}getHurtboxRect(){return new f.Geom.Rectangle(this.x-d.BODY_WIDTH/2,this.y-d.BODY_HEIGHT/2,d.BODY_WIDTH,d.BODY_HEIGHT)}takeDamage(t,e){if(this.armorActive){this.health-=t*.3,this.health=Math.max(0,this.health);return}this.state===l.BLOCK?(this.health-=t*(1-d.BLOCK_DAMAGE_REDUCTION),this.body.body.setVelocityX(e*.3)):(this.health-=t,this.body.body.setVelocityX(e),this.body.body.setVelocityY(-150),this.enterState(l.HIT)),this.health=Math.max(0,this.health),this.health<=0&&(this.enterState(l.KO),this.canAct=!1)}onAttackBlocked(t){this.body.body.setVelocityX(-t*d.BLOCK_ATTACKER_PUSHBACK),this.attackCooldown=d.BLOCK_ATTACKER_STUN,this.canAct=!1,this.scene.time.delayedCall(d.BLOCK_ATTACKER_STUN,()=>{this.state!==l.KO&&(this.canAct=!0)})}setFacing(t){this.facingRight=t}resetForRound(t){this.body.setPosition(t,d.GROUND_Y-d.BODY_HEIGHT/2),this.body.body.setVelocity(0,0),this.health=this.maxHealth,this.state=l.IDLE,this.stateTimer=0,this.specialCooldown=0,this.canAct=!0,this.hasHit=!1,this.specialHitCount=0,this.armorActive=!1,this._effectPhase=0,this._effectTimer=0,this.attackCooldown=0,this.lastAttackType=null,this.sameAttackCount=0,this.timeSinceLastAttack=0}draw(){const t=w[this.state];if(!t)return;let e;const i=t.length;if(i===1)e=t[0];else{let h,r=!1;switch(this.state){case l.PUNCH:h=d.PUNCH_DURATION;break;case l.KICK:h=d.KICK_DURATION;break;case l.SPECIAL:h=this.specialDuration;break;case l.KO:h=800;break;case l.JUMP:h=600;break;case l.HIT:h=d.HITSTUN_DURATION;break;case l.IDLE:h=800,r=!0;break;case l.WALK_FORWARD:h=400,r=!0;break;case l.WALK_BACKWARD:h=450,r=!0;break;case l.VICTORY:h=900,r=!0;break;default:h=400;break}const c=r?this.stateTimer%h:this.stateTimer,y=h/i,x=r?Math.floor(c/y)%i:Math.min(Math.floor(c/y),i-1),L=r?(x+1)%i:Math.min(x+1,i-1),C=c%y/y;x===L||this.state===l.KO?e=t[x]:e=z(t[x],t[L],C)}const s=this.x,a=this.y+d.BODY_HEIGHT/2-60,o=this.isAttacking();this.renderer.draw(s,a,e,this.facingRight,this.data.color,o)}destroy(){this.graphics.destroy(),this.body.destroy()}}const ct={0:{left:"A",right:"D",jump:"W",punch:"J",kick:"K",special:"L",block:"S"},1:{left:"LEFT",right:"RIGHT",jump:"UP",punch:"COMMA",kick:"PERIOD",special:"MINUS",block:"DOWN"}};class G{constructor(t,e){this.scene=t,this.playerIndex=e,this.gamepad=null;const i=ct[e];this.keys={};for(const s in i)this.keys[s]=t.input.keyboard.addKey(f.Input.Keyboard.KeyCodes[i[s]]);this.prevState={jump:!1,punch:!1,kick:!1,special:!1},t.input.gamepad&&(t.input.gamepad.on("connected",s=>{s.index===e&&!this.gamepad&&(this.gamepad=s)}),t.input.gamepad.pad1&&e===0&&(this.gamepad=t.input.gamepad.pad1),t.input.gamepad.pad2&&e===1&&(this.gamepad=t.input.gamepad.pad2))}getActions(){const t=this.readKeyboard(),e=this.readGamepad(),i={left:t.left||e.left,right:t.right||e.right,jump:t.jump||e.jump,punch:t.punch||e.punch,kick:t.kick||e.kick,special:t.special||e.special,block:t.block||e.block},s={left:i.left,right:i.right,jump:i.jump&&!this.prevState.jump,punch:i.punch&&!this.prevState.punch,kick:i.kick&&!this.prevState.kick,special:i.special&&!this.prevState.special,block:i.block};return this.prevState={jump:i.jump,punch:i.punch,kick:i.kick,special:i.special},s}readKeyboard(){return{left:this.keys.left.isDown,right:this.keys.right.isDown,jump:this.keys.jump.isDown,punch:this.keys.punch.isDown,kick:this.keys.kick.isDown,special:this.keys.special.isDown,block:this.keys.block.isDown}}readGamepad(){const t=this.gamepad,e={left:!1,right:!1,jump:!1,punch:!1,kick:!1,special:!1,block:!1};if(!t||!t.connected)return e;const i=.3,s=t.leftStick?t.leftStick.x:0;return{left:t.left||s<-i,right:t.right||s>i,jump:t.A,punch:t.B,kick:t.Y,special:t.X,block:t.L1||t.R1}}}class F{constructor(t,e,i,s,a,o){this.x=e,this.y=i,this.width=s,this.height=a,this.playerIndex=o,this.graphics=t.add.graphics(),this.graphics.setDepth(100)}update(t,e){const i=this.graphics;i.clear();const s=Math.max(0,t/e),a=this.width*s,o=this.playerIndex===0;i.fillStyle(3355443,1),i.fillRect(this.x,this.y,this.width,this.height);let h;s>.5?h=52292:s>.25?h=13421568:h=13369344,i.fillStyle(h,1),o?i.fillRect(this.x,this.y,a,this.height):i.fillRect(this.x+this.width-a,this.y,a,this.height),i.lineStyle(2,16777215,1),i.strokeRect(this.x,this.y,this.width,this.height)}destroy(){this.graphics.destroy()}}class W{constructor(t,e,i,s=!1){this.x=e,this.y=i,this.alignRight=s,this.graphics=t.add.graphics(),this.graphics.setDepth(100)}update(t){const e=this.graphics;e.clear();for(let i=0;i<d.ROUNDS_TO_WIN;i++){const s=this.alignRight?this.x-i*25:this.x+i*25;i<t&&(e.fillStyle(16763904,1),e.fillCircle(s,this.y,8)),e.lineStyle(2,6710886,1),e.strokeCircle(s,this.y,8)}}destroy(){this.graphics.destroy()}}class lt extends f.Scene{constructor(){super("FightScene")}create(){this.p1Wins=this.registry.get("p1Wins"),this.p2Wins=this.registry.get("p2Wins"),this.currentRound=this.registry.get("currentRound"),this.roundActive=!1,this.createArena(),this.createFighters(),this.createUI(),this.startRound()}createArena(){const t=this.add.graphics();t.fillStyle(1450302,1),t.fillRect(0,0,1280,d.GROUND_Y),t.fillStyle(3355460,1),t.fillRect(0,d.GROUND_Y,1280,100),t.lineStyle(3,5592439,1),t.lineBetween(0,d.GROUND_Y,1280,d.GROUND_Y),t.lineStyle(1,3355477,.5),t.lineBetween(d.STAGE_LEFT,0,d.STAGE_LEFT,d.GROUND_Y),t.lineBetween(d.STAGE_RIGHT,0,d.STAGE_RIGHT,d.GROUND_Y),this.physics.world.setBounds(d.STAGE_LEFT,0,d.STAGE_RIGHT-d.STAGE_LEFT,d.GROUND_Y),this.ground=this.add.zone(640,d.GROUND_Y+10,1280,20),this.physics.add.existing(this.ground,!0)}createFighters(){const i=k[this.registry.get("p1Fighter")||0],s=k[this.registry.get("p2Fighter")||1];this.p1Data=i,this.p2Data=s,this.fighter1=new N(this,350,d.GROUND_Y,0,!0,i),this.fighter2=new N(this,930,d.GROUND_Y,1,!1,s),this.fighter1.opponent=this.fighter2,this.fighter2.opponent=this.fighter1,this.physics.add.collider(this.fighter1.body,this.ground),this.physics.add.collider(this.fighter2.body,this.ground),this.physics.add.collider(this.fighter1.body,this.fighter2.body),this.p1Input=new G(this,0),this.p2Input=new G(this,1)}createUI(){this.p1HealthBar=new F(this,50,25,480,28,0),this.p2HealthBar=new F(this,750,25,480,28,1),this.add.text(50,7,this.p1Data.name,{fontSize:"14px",fontFamily:"monospace",color:`#${this.p1Data.color.toString(16).padStart(6,"0")}`}),this.add.text(1230,7,this.p2Data.name,{fontSize:"14px",fontFamily:"monospace",color:`#${this.p2Data.color.toString(16).padStart(6,"0")}`}).setOrigin(1,0),this.p1RoundInd=new W(this,50,71,!1),this.p2RoundInd=new W(this,1230,71,!0),this.add.text(640,30,"VS",{fontSize:"20px",fontFamily:"monospace",color:"#666666",fontStyle:"bold"}).setOrigin(.5),this.roundText=this.add.text(640,68,`Round ${this.currentRound}`,{fontSize:"13px",fontFamily:"monospace",color:"#555555"}).setOrigin(.5);const s=80,a=6,o=91;this.spBarConfig={w:s,h:a},this.add.text(50,o-2,"SP",{fontSize:"9px",fontFamily:"monospace",color:"#666666"}),this.add.text(1230,o-2,"SP",{fontSize:"9px",fontFamily:"monospace",color:"#666666"}).setOrigin(1,0),this.p1SpBar=this.add.graphics(),this.p1SpBarX=68,this.p1SpBarY=o,this.p2SpBar=this.add.graphics(),this.p2SpBarX=1230-s,this.p2SpBarY=o,this.p1HealthBar.update(d.MAX_HEALTH,d.MAX_HEALTH),this.p2HealthBar.update(d.MAX_HEALTH,d.MAX_HEALTH),this.p1RoundInd.update(this.p1Wins),this.p2RoundInd.update(this.p2Wins)}startRound(){this.roundActive=!1;const t=this.add.text(640,300,`ROUND ${this.currentRound}`,{fontSize:"64px",fontFamily:"monospace",color:"#ffffff",fontStyle:"bold"}).setOrigin(.5).setDepth(200);this.time.delayedCall(1e3,()=>{t.setText("FIGHT!"),t.setColor("#ffcc00"),t.setFontSize("80px"),p.roundStart(),this.time.delayedCall(600,()=>{this.tweens.add({targets:t,alpha:0,duration:300,onComplete:()=>t.destroy()}),this.roundActive=!0})})}update(t,e){if(this.p1HealthBar.update(this.fighter1.health,this.fighter1.maxHealth),this.p2HealthBar.update(this.fighter2.health,this.fighter2.maxHealth),this.p1RoundInd.update(this.p1Wins),this.p2RoundInd.update(this.p2Wins),this.drawSpBar(this.p1SpBar,this.p1SpBarX,this.p1SpBarY,this.fighter1.specialCooldown,this.p1Data.color),this.drawSpBar(this.p2SpBar,this.p2SpBarX,this.p2SpBarY,this.fighter2.specialCooldown,this.p2Data.color),!this.roundActive)return;const i=this.p1Input.getActions(),s=this.p2Input.getActions();this.fighter1.update(e,i),this.fighter2.update(e,s),this.updateFacing(),this.checkHits(this.fighter1,this.fighter2),this.checkHits(this.fighter2,this.fighter1),this.fighter1.health<=0&&this.fighter1.state==="KO"?this.endRound(1):this.fighter2.health<=0&&this.fighter2.state==="KO"&&this.endRound(0)}updateFacing(){this.fighter1.x<this.fighter2.x?(this.fighter1.setFacing(!0),this.fighter2.setFacing(!1)):(this.fighter1.setFacing(!1),this.fighter2.setFacing(!0))}checkHits(t,e){if(!t.isAttacking()||!t.isOnActiveFrame()||t.hasHit)return;const i=t.getHitboxRect(),s=e.getHurtboxRect();if(!(!i||!s)&&f.Geom.Rectangle.Overlaps(i,s)){t.hasHit=!0;const a=t.getAttackData(),o=t.facingRight?1:-1,h=e.state==="BLOCK";e.takeDamage(a.damage,o*a.knockback),h?(t.onAttackBlocked(o),p.block()):p.hit(),this.cameras.main.shake(100,.005*a.damage),this.createHitSpark(i.x+i.width/2,i.y+i.height/2,h)}}createHitSpark(t,e,i){const s=this.add.graphics();s.setDepth(50);const a=i?4491519:16755200,o=i?15:25;for(let h=0;h<8;h++){const r=Math.PI*2*h/8,c=o+Math.random()*10;s.lineStyle(3,a,1),s.lineBetween(t,e,t+Math.cos(r)*c,e+Math.sin(r)*c)}this.tweens.add({targets:s,alpha:0,duration:200,onComplete:()=>s.destroy()})}drawSpBar(t,e,i,s,a){const{w:o,h}=this.spBarConfig,r=s<=0?1:1-s/d.SPECIAL_COOLDOWN;t.clear(),t.fillStyle(1118498,.8),t.fillRect(e,i,o,h);const c=r>=1?16763904:a;t.fillStyle(c,r>=1?.9:.6),t.fillRect(e,i,o*r,h),t.lineStyle(1,r>=1?16763904:4473958,.8),t.strokeRect(e,i,o,h)}endRound(t){this.roundActive=!1,t===0?this.p1Wins++:this.p2Wins++;const e=t===0?this.fighter1:this.fighter2,i=t===0?this.fighter2:this.fighter1;e.enterState("VICTORY"),i.enterState("KO");const s=this.add.text(640,300,"K.O.!",{fontSize:"80px",fontFamily:"monospace",color:"#ff3333",fontStyle:"bold"}).setOrigin(.5).setDepth(200);p.ko(),this.cameras.main.shake(300,.01),this.time.delayedCall(d.ROUND_END_DELAY,()=>{s.destroy(),this.p1Wins>=d.ROUNDS_TO_WIN||this.p2Wins>=d.ROUNDS_TO_WIN?(this.registry.set("p1Wins",this.p1Wins),this.registry.set("p2Wins",this.p2Wins),this.registry.set("matchWinner",t),this.cleanUp(),this.scene.start("ResultScene")):(this.registry.set("p1Wins",this.p1Wins),this.registry.set("p2Wins",this.p2Wins),this.registry.set("currentRound",this.currentRound+1),this.cleanUp(),this.scene.restart())})}cleanUp(){this.fighter1.destroy(),this.fighter2.destroy(),this.p1HealthBar.destroy(),this.p2HealthBar.destroy(),this.p1RoundInd.destroy(),this.p2RoundInd.destroy()}}class dt extends f.Scene{constructor(){super("ResultScene")}create(){const t=this.registry.get("matchWinner"),e=this.registry.get("p1Wins"),i=this.registry.get("p2Wins"),s=this.registry.get("p1Fighter")||0,a=this.registry.get("p2Fighter")||1,o=t===0?k[s]:k[a],h=t===0?k[a]:k[s];p.victory();const r=t===0?"PLAYER 1":"PLAYER 2";this.add.text(640,120,`${r} WINS!`,{fontSize:"64px",fontFamily:"monospace",color:"#ffcc00",fontStyle:"bold"}).setOrigin(.5),this.add.text(640,190,o.name,{fontSize:"28px",fontFamily:"monospace",color:t===0?"#ffffff":"#00ffff"}).setOrigin(.5),this.add.text(640,250,`${e} - ${i}`,{fontSize:"48px",fontFamily:"monospace",color:"#ffffff"}).setOrigin(.5);const c=this.add.graphics();new T(c).draw(640,460,w.VICTORY[0],!0,o.color);const x=this.add.graphics(),L=new T(x),C=w.KO[w.KO.length-1],P=t===0?900:380;L.draw(P,480,C,t!==0,h.color);const O=this.add.text(640,620,"Press ENTER or SPACE to play again",{fontSize:"22px",fontFamily:"monospace",color:"#ffcc00"}).setOrigin(.5);this.tweens.add({targets:O,alpha:.3,duration:600,yoyo:!0,repeat:-1}),this.input.keyboard.on("keydown-ENTER",this.restart,this),this.input.keyboard.on("keydown-SPACE",this.restart,this),this.input.gamepad.on("down",()=>this.restart())}restart(){p.menuSelect(),this.scene.start("CharacterSelectScene")}}const yt={type:f.AUTO,width:1280,height:720,parent:"game-container",backgroundColor:"#1a1a2e",physics:{default:"arcade",arcade:{gravity:{y:1200},debug:!1}},scale:{mode:f.Scale.FIT,autoCenter:f.Scale.CENTER_BOTH},input:{gamepad:!0},scene:[X,J,q,lt,dt]};new f.Game(yt);
